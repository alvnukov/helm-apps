global:
  env: production
  _includes:
    base-a:
      data:
        fromBaseA: "A"
    base-b:
      data:
        fromBaseB: "B"
    profile-base:
      enabled: true
      _include: ["base-a"]
      envVars:
        A: "1"
        ENV_SWITCH:
          _default: "base-default"
          production: "base-production"
      data:
        key1: "value-1"
        key2: "base-value-2"
    profile-override:
      _include: ["base-b"]
      envVars:
        A: "2"
        ENV_SWITCH:
          _default: "override-default"
      data:
        key2: "override-value-2"
        key4: "value-4"

apps-configmaps:
  merge-contract:
    _include: ["profile-base", "profile-override"]
    enabled: true
    envVars:
      LOCAL: "ok"
    data:
      key2: "local-value-2"
      key3: "value-3"
  compat-config:
    enabled: true
    extraFields: |
      immutable: true
    data:
      key: value

apps-stateless:
  compat-service:
    enabled: true
    extraSpec: |
      paused: true
    podSpecExtra: |
      os:
        name: linux
    containers:
      main:
        image:
          name: alpine
          staticTag: "3"
        command: |
          - sh
        args: |
          - -c
          - sleep 3600
        ports: |
          - name: http
            containerPort: 8080
        extraFields: |
          resizePolicy:
            - resourceName: cpu
              restartPolicy: NotRequired
    service:
      enabled: true
      type: LoadBalancer
      allocateLoadBalancerNodePorts: true
      loadBalancerClass: internal-vip
      internalTrafficPolicy: Local
      ipFamilyPolicy: SingleStack
      ipFamilies: |
        - IPv4
      ports: |
        - name: http
          port: 80
          targetPort: 8080
      extraSpec: |
        externalTrafficPolicy: Local

apps-jobs:
  compat-job:
    enabled: true
    containers:
      main:
        image:
          name: alpine
          staticTag: "3"
        command: |
          - sh
        args: |
          - -c
          - echo test
    jobTemplateExtraSpec: |
      podFailurePolicy:
        rules: []

apps-ingresses:
  compat-ingress:
    enabled: true
    host: app.example.com
    paths: |
      - path: /
        pathType: Prefix
        backend:
          service:
            name: compat-service
            port:
              number: 80
    extraSpec: |
      defaultBackend:
        service:
          name: compat-service
          port:
            number: 80

apps-pvcs:
  compat-pvc:
    enabled: true
    accessModes: |
      - ReadWriteOnce
    resources: |
      requests:
        storage: 1Gi
    extraSpec: |
      volumeMode: Filesystem

apps-secrets:
  compat-secret:
    enabled: true
    extraFields: |
      stringData:
        token: value
