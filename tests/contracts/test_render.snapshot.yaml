---
# Source: contracts/templates/init-helm-apps-library.yaml
# Helm Apps Library: apps-k8s-manifests.compat-generic-priorityclass

apiVersion: scheduling.k8s.io/v1
kind: PriorityClass
metadata:
  name: "compat-generic-priorityclass"
  
  labels:
    
    app: "compat-generic-priorityclass"
    chart: "contracts"





description: "compat priority class"

globalDefault: false

preemptionPolicy: "PreemptLowerPriority"

value: 100000
---
# Source: contracts/templates/init-helm-apps-library.yaml
# Helm Apps Library: apps-network-policies.compat-calico-netpol
apiVersion: projectcalico.org/v3
kind: NetworkPolicy
metadata:
  name: "compat-calico-netpol"
  
  labels:
    
    app: "compat-calico-netpol"
    chart: "contracts"
spec:
  selector: "app == 'compat-service'"
  types:
    - Ingress
    - Egress
  ingress:
  - action: Allow
    source:
      selector: "kubernetes.io/metadata.name == 'ingress-nginx'"
  
  egress:
  - action: Allow
    destination:
      selector: "kubernetes.io/metadata.name == 'kube-system'"
---
# Source: contracts/templates/init-helm-apps-library.yaml
# Helm Apps Library: apps-network-policies.compat-netpol
apiVersion: networking.k8s.io/v1
kind: NetworkPolicy
metadata:
  name: "compat-netpol"
  
  labels:
    
    app: "compat-netpol"
    chart: "contracts"
spec:
  podSelector:
    matchLabels:
      app: compat-service
  policyTypes:
  - Ingress
  - Egress
  
  ingress:
  - from:
      - namespaceSelector:
          matchLabels:
            kubernetes.io/metadata.name: ingress-nginx
  
  egress:
  - to:
      - namespaceSelector:
          matchLabels:
            kubernetes.io/metadata.name: kube-system
    ports:
      - protocol: UDP
        port: 53
---
# Source: contracts/templates/init-helm-apps-library.yaml
# Helm Apps Library: apps-limit-range.compat-limit-range
apiVersion: v1
kind: LimitRange
metadata:
  name: "compat-limit-range"
  
  labels:
    
    app: "compat-limit-range"
    chart: "contracts"
spec:
  limits:
    - type: Container
      default:
        memory: 256Mi
      defaultRequest:
        memory: 128Mi
---
# Source: contracts/templates/init-helm-apps-library.yaml
# Helm Apps Library: apps-service-accounts.compat-standalone-sa
apiVersion: v1
kind: ServiceAccount
metadata:
  name: "compat-standalone-sa"
  
  labels:
    
    app: "compat-standalone-sa"
    chart: "contracts"
  namespace: "compat"
automountServiceAccountToken: false
imagePullSecrets:
  - name: compat-regcred
secrets:
  - name: compat-static-token
---
# Source: contracts/templates/init-helm-apps-library.yaml
# Helm Apps Library: apps-k8s-manifests.compat-generic-serviceaccount

apiVersion: v1
kind: ServiceAccount
metadata:
  name: "compat-generic-serviceaccount"
  
  labels:
    
    app: "compat-generic-serviceaccount"
    chart: "contracts"
    imported-by: helm-apps-importer

  namespace: compat





automountServiceAccountToken: false

imagePullSecrets:

  - name: compat-regcred

secrets:

  - name: compat-token
---
# Source: contracts/templates/init-helm-apps-library.yaml
---
# Helm Apps Library: apps-stateless.compat-env-mixed.containers.main.secretEnvVars
apiVersion: v1
kind: Secret
metadata:
  name: "envs-containers-compat-env-mixed-main"
  labels: 
    app: "compat-env-mixed"
    chart: "contracts"
type: Opaque
data: 
  "ORDER_KEY": "ZnJvbS1zZWNyZXQtZW52LXZhcnM="
---
# Source: contracts/templates/init-helm-apps-library.yaml
---
# Helm Apps Library: apps-stateless.compat-env-old.containers.main.secretEnvVars
apiVersion: v1
kind: Secret
metadata:
  name: "envs-containers-compat-env-old-main"
  labels: 
    app: "compat-env-old"
    chart: "contracts"
type: Opaque
data: 
  "ORDER_KEY": "ZnJvbS1zZWNyZXQtZW52LXZhcnM="
---
# Source: contracts/templates/init-helm-apps-library.yaml
---
# Helm Apps Library: apps-stateless.compat-service.containers.main.runtime-secret.txt
apiVersion: v1
kind: Secret
metadata:
  name: "config-containers-compat-service-main-runtime-secret-txt"
  labels: 
    app: "compat-service"
    chart: "contracts"
type: Opaque
data:
  "runtime-secret.txt": "c3VwZXItc2VjcmV0LWRhdGE="
---
# Source: contracts/templates/init-helm-apps-library.yaml
# Helm Apps Library: apps-secrets.common-runtime
apiVersion: v1
kind: Secret
metadata:
  name: "common-runtime"
  
  labels:
    
    app: "common-runtime"
    chart: "contracts"
type:
  Opaque
data:
  
  "ORDER_KEY": "ZnJvbS1zaGFyZWQ="
  "SHARED_MODE": "c3RyaWN0"
  "SHARED_REGION": "ZXUtY2VudHJhbC0x"
---
# Source: contracts/templates/init-helm-apps-library.yaml
# Helm Apps Library: apps-secrets.compat-secret
apiVersion: v1
kind: Secret
metadata:
  name: "compat-secret"
  
  labels:
    
    app: "compat-secret"
    chart: "contracts"
stringData:
  token: value
type:
  Opaque
data:
---
# Source: contracts/templates/init-helm-apps-library.yaml
# Helm Apps Library: apps-secrets.manual-env-mixed
apiVersion: v1
kind: Secret
metadata:
  name: "manual-env-mixed"
  
  labels:
    
    app: "manual-env-mixed"
    chart: "contracts"
type:
  Opaque
data:
  
  "ORDER_KEY": "ZnJvbS1tYW51YWwtbWl4ZWQ="
---
# Source: contracts/templates/init-helm-apps-library.yaml
# Helm Apps Library: apps-secrets.manual-env-old
apiVersion: v1
kind: Secret
metadata:
  name: "manual-env-old"
  
  labels:
    
    app: "manual-env-old"
    chart: "contracts"
type:
  Opaque
data:
  
  "ORDER_KEY": "ZnJvbS1tYW51YWwtb2xk"
---
# Source: contracts/templates/init-helm-apps-library.yaml
# Helm Apps Library: custom-group-contract.custom-group-cm
apiVersion: v1
kind: ConfigMap
metadata:
  name: "custom-group-cm"
  
  labels:
    
    app: "custom-group-cm"
    chart: "contracts"

data:
  "custom": "ok"
---
# Source: contracts/templates/init-helm-apps-library.yaml
# Helm Apps Library: apps-configmaps.common-runtime-cm
apiVersion: v1
kind: ConfigMap
metadata:
  name: "common-runtime-cm"
  
  labels:
    
    app: "common-runtime-cm"
    chart: "contracts"

data:
  "APP_MODE": "runtime"
  "APP_ZONE": "eu-central-1"
---
# Source: contracts/templates/init-helm-apps-library.yaml
# Helm Apps Library: apps-configmaps.compat-config
apiVersion: v1
kind: ConfigMap
metadata:
  name: "compat-config"
  
  labels:
    
    app: "compat-config"
    chart: "contracts"
immutable: true

data:
  "key": "value"
---
# Source: contracts/templates/init-helm-apps-library.yaml
# Helm Apps Library: apps-configmaps.merge-contract
apiVersion: v1
kind: ConfigMap
metadata:
  name: "merge-contract"
  
  labels:
    
    app: "merge-contract"
    chart: "contracts"

data:
  "A": "2"
  "ENV_SWITCH": "base-production"
  "LOCAL": "ok"
  
  "fromBaseA": "A"
  "fromBaseB": "B"
  "key1": "value-1"
  "key2": "local-value-2"
  "key3": "value-3"
  "key4": "value-4"
---
# Source: contracts/templates/init-helm-apps-library.yaml
# Helm Apps Library: apps-pvcs.compat-pvc
kind: PersistentVolumeClaim
apiVersion: v1
metadata:
  name: "compat-pvc"
  
  labels:
    
    app: "compat-pvc"
    chart: "contracts"
spec:  
  accessModes: 
  - ReadWriteOnce
  resources: 
    requests:
      storage: 1Gi
  volumeMode: Filesystem
---
# Source: contracts/templates/init-helm-apps-library.yaml
apiVersion: rbac.authorization.k8s.io/v1
kind: ClusterRole
metadata:
  name: "compat-standalone-sa-metrics-reader"
  
  labels:
    
    app: "compat-standalone-sa"
    chart: "contracts"
rules:

-
 apiGroups:
  - ""
 resources:
  - pods
  - nodes
 verbs:
  - get
  - list
aggregationRule:
  clusterRoleSelectors:
    - matchLabels:
        rbac.example.com/aggregate-to-compat: "true"
---
# Source: contracts/templates/init-helm-apps-library.yaml
apiVersion: rbac.authorization.k8s.io/v1
kind: ClusterRoleBinding
metadata:
  name: "compat-standalone-sa-metrics-reader"
  
  labels:
    
    app: "compat-standalone-sa"
    chart: "contracts"
subjects:
  - kind: ServiceAccount
    name: compat-standalone-sa
    namespace: compat
roleRef:
  apiGroup: rbac.authorization.k8s.io
  kind: ClusterRole
  name: compat-standalone-sa-metrics-reader
---
# Source: contracts/templates/init-helm-apps-library.yaml
apiVersion: rbac.authorization.k8s.io/v1
kind: Role
metadata:
  name: "compat-standalone-sa-reader"
  
  labels:
    
    app: "compat-standalone-sa"
    chart: "contracts"
  namespace: "compat"
rules:

-
 apiGroups:
  - ""
 resources:
  - configmaps
 verbs:
  - get
  - list
  - watch

-
 apiGroups:
  - ""
 resources:
  - secrets
 verbs:
  - get
  - list
 resourceNames:
   - compat-secret
---
# Source: contracts/templates/init-helm-apps-library.yaml
apiVersion: rbac.authorization.k8s.io/v1
kind: Role
metadata:
  name: "compat-standalone-sa-writer"
  
  labels:
    
    app: "compat-standalone-sa"
    chart: "contracts"
  namespace: "compat"
rules:

-
 apiGroups:
  - ""
 resources:
  - configmaps
 verbs:
  - create
  - update
  - patch
---
# Source: contracts/templates/init-helm-apps-library.yaml
apiVersion: rbac.authorization.k8s.io/v1
kind: RoleBinding
metadata:
  name: "compat-reader-binding"
  
  labels:
    
    app: "compat-standalone-sa"
    chart: "contracts"
    rbac.example.com/source: compat
    
  namespace: "compat"
subjects:
  - kind: ServiceAccount
    name: compat-standalone-sa
    namespace: compat
  - kind: User
    name: alice@example.com
roleRef:
  apiGroup: rbac.authorization.k8s.io
  kind: Role
  name: compat-standalone-sa-reader
---
# Source: contracts/templates/init-helm-apps-library.yaml
apiVersion: rbac.authorization.k8s.io/v1
kind: RoleBinding
metadata:
  name: "compat-standalone-sa-writer"
  
  labels:
    
    app: "compat-standalone-sa"
    chart: "contracts"
  namespace: "compat"
subjects:
  - kind: ServiceAccount
    name: compat-standalone-sa
    namespace: compat
roleRef:
  apiGroup: rbac.authorization.k8s.io
  kind: Role
  name: compat-standalone-sa-writer
---
# Source: contracts/templates/init-helm-apps-library.yaml
# Helm Apps Library: apps-k8s-manifests.compat-generic-rolebinding

apiVersion: rbac.authorization.k8s.io/v1
kind: RoleBinding
metadata:
  name: "compat-generic-rolebinding"
  
  labels:
    
    app: "compat-generic-rolebinding"
    chart: "contracts"

  namespace: compat





roleRef:

  apiGroup: rbac.authorization.k8s.io
  kind: Role
  name: compat-reader

subjects:

  - kind: ServiceAccount
    name: compat-sa
    namespace: compat
---
# Source: contracts/templates/init-helm-apps-library.yaml
---
# Helm Apps Library: apps-stateless.compat-service.service
apiVersion: v1
kind: Service
metadata:
  name: "compat-service"
  
  labels:
    
    app: "compat-service"
    chart: "contracts"
spec:
  
  ipFamilies: 
  - IPv4
  ports: 
  - name: http
    port: 80
    targetPort: 8080
  selector: 
    app: "compat-service"
  internalTrafficPolicy: "Local"
  ipFamilyPolicy: "SingleStack"
  loadBalancerClass: "internal-vip"
  type: "LoadBalancer"
  allocateLoadBalancerNodePorts: true
  externalTrafficPolicy: Local
---
# Source: contracts/templates/init-helm-apps-library.yaml
---
# Helm Apps Library: apps-stateless.native-list-optin.service
apiVersion: v1
kind: Service
metadata:
  name: "native-list-optin"
  
  labels:
    
    app: "native-list-optin"
    chart: "contracts"
spec:
  
  ports: 
  - name: http
    port: 8088
    targetPort: 8088
  selector: 
    app: "native-list-optin"
---
# Source: contracts/templates/init-helm-apps-library.yaml
---
# Helm Apps Library: apps-stateful.compat-stateful.service
apiVersion: v1
kind: Service
metadata:
  name: "compat-stateful"
  
  labels:
    
    app: "compat-stateful"
    chart: "contracts"
spec:
  
  ports: 
  - name: http
    port: 81
    targetPort: 8081
  selector: 
    app: "compat-stateful"
---
# Source: contracts/templates/init-helm-apps-library.yaml
# Helm Apps Library: apps-services.compat-standalone-service
apiVersion: v1
kind: Service
metadata:
  name: "compat-standalone-service"
  
  labels:
    
    app: "compat-standalone-service"
    chart: "contracts"
spec:
  
  ports: 
  - name: metrics
    port: 9090
    targetPort: 9090
  selector: 
    app: compat-service
---
# Source: contracts/templates/init-helm-apps-library.yaml
# Helm Apps Library: apps-stateless.compat-env-mixed


apiVersion: apps/v1
kind: Deployment

metadata:
  name: "compat-env-mixed"
  
  annotations:
    checksum/config: "e3b0c44298fc1c149afbf4c8996fb92427ae41e4649b934ca495991b7852b855"
  labels:
    
    app: "compat-env-mixed"
    chart: "contracts"
spec:  
  template: 
    metadata:
      name: "compat-env-mixed"
      
      annotations:
        checksum/config: "e3b0c44298fc1c149afbf4c8996fb92427ae41e4649b934ca495991b7852b855"
      labels:
        
        app: "compat-env-mixed"
        chart: "contracts"
    spec:
      
      containers:
      - name: "main"
        image: alpine:3
        envFrom:
        - secretRef:
            name: "common-runtime"
        - secretRef:
            name: "manual-env-mixed"
        - secretRef:
            name: "envs-containers-compat-env-mixed-main"
        
        args: 
        - -c
        - sleep 3600
        command: 
        - sh
  selector: 
    matchLabels:
      
      app: "compat-env-mixed"
---
# Source: contracts/templates/init-helm-apps-library.yaml
# Helm Apps Library: apps-stateless.compat-env-old


apiVersion: apps/v1
kind: Deployment

metadata:
  name: "compat-env-old"
  
  annotations:
    checksum/config: "e3b0c44298fc1c149afbf4c8996fb92427ae41e4649b934ca495991b7852b855"
  labels:
    
    app: "compat-env-old"
    chart: "contracts"
spec:  
  template: 
    metadata:
      name: "compat-env-old"
      
      annotations:
        checksum/config: "e3b0c44298fc1c149afbf4c8996fb92427ae41e4649b934ca495991b7852b855"
      labels:
        
        app: "compat-env-old"
        chart: "contracts"
    spec:
      
      containers:
      - name: "main"
        image: alpine:3
        envFrom:
        - secretRef:
            name: "manual-env-old"
        - secretRef:
            name: "envs-containers-compat-env-old-main"
        
        args: 
        - -c
        - sleep 3600
        command: 
        - sh
  selector: 
    matchLabels:
      
      app: "compat-env-old"
---
# Source: contracts/templates/init-helm-apps-library.yaml
# Helm Apps Library: apps-stateless.compat-service


apiVersion: apps/v1
kind: Deployment

metadata:
  name: "compat-service"
  
  annotations:
    checksum/config: "5be0410867946d64eeca94d189dcc027a1c8bc5d4d56fc9a8b9174fba4860d5c"
  labels:
    
    app: "compat-service"
    chart: "contracts"
spec:  
  template: 
    metadata:
      name: "compat-service"
      
      annotations:
        checksum/config: "5be0410867946d64eeca94d189dcc027a1c8bc5d4d56fc9a8b9174fba4860d5c"
      labels:
        
        app: "compat-service"
        chart: "contracts"
    spec:
      
      containers:
      - name: "main"
        image: alpine:3
        envFrom:
        - configMapRef:
            name: "common-runtime-cm"
        - secretRef:
            name: "common-runtime"
        
        volumeMounts: 
        - name: "config-containers-compat-service-main-runtime-secret-txt"
          subPath: "runtime-secret.txt"
          mountPath: "/etc/runtime-secret.txt"
        args: 
        - -c
        - sleep 3600
        command: 
        - sh
        ports: 
        - name: http
          containerPort: 8080
        workingDir: "/app"
        resizePolicy:
          - resourceName: cpu
            restartPolicy: NotRequired
      volumes: 
      - name: "config-containers-compat-service-main-runtime-secret-txt"
        secret:
          secretName: "config-containers-compat-service-main-runtime-secret-txt"
      os:
        name: linux
  selector: 
    matchLabels:
      
      app: "compat-service"
  paused: true
---
# Source: contracts/templates/init-helm-apps-library.yaml
# Helm Apps Library: apps-stateless.native-list-optin


apiVersion: apps/v1
kind: Deployment

metadata:
  name: "native-list-optin"
  
  annotations:
    checksum/config: "e3b0c44298fc1c149afbf4c8996fb92427ae41e4649b934ca495991b7852b855"
  labels:
    
    app: "native-list-optin"
    chart: "contracts"
spec:  
  template: 
    metadata:
      name: "native-list-optin"
      
      annotations:
        checksum/config: "e3b0c44298fc1c149afbf4c8996fb92427ae41e4649b934ca495991b7852b855"
      labels:
        
        app: "native-list-optin"
        chart: "contracts"
    spec:
      
      containers:
      - name: "main"
        image: alpine:3
        
        args: 
        - -c
        - sleep 3600
        command: 
        - sh
        ports: 
        - containerPort: 8088
          name: http
  selector: 
    matchLabels:
      
      app: "native-list-optin"
---
# Source: contracts/templates/init-helm-apps-library.yaml
# Helm Apps Library: apps-stateless.release-auto-app


apiVersion: apps/v1
kind: Deployment

metadata:
  name: "release-auto-app"
  
  annotations:
    checksum/config: "e3b0c44298fc1c149afbf4c8996fb92427ae41e4649b934ca495991b7852b855"
    helm-apps/app-version: "3.19"
    helm-apps/release: "production-v1"
  labels:
    
    app: "release-auto-app"
    chart: "contracts"
spec:  
  template: 
    metadata:
      name: "release-auto-app"
      
      annotations:
        checksum/config: "e3b0c44298fc1c149afbf4c8996fb92427ae41e4649b934ca495991b7852b855"
        helm-apps/app-version: "3.19"
        helm-apps/release: "production-v1"
      labels:
        
        app: "release-auto-app"
        chart: "contracts"
    spec:
      
      containers:
      - name: "main"
        image: alpine:3.19
        
        args: 
        - -c
        - sleep 3600
        command: 
        - sh
  selector: 
    matchLabels:
      
      app: "release-auto-app"
---
# Source: contracts/templates/init-helm-apps-library.yaml
# Helm Apps Library: apps-stateful.compat-stateful


apiVersion: apps/v1
kind: StatefulSet

metadata:
  name: "compat-stateful"
  
  annotations:
    checksum/config: "e3b0c44298fc1c149afbf4c8996fb92427ae41e4649b934ca495991b7852b855"
  labels:
    
    app: "compat-stateful"
    chart: "contracts"
spec:
  
  template: 
    metadata:
      name: "compat-stateful"
      
      annotations:
        checksum/config: "e3b0c44298fc1c149afbf4c8996fb92427ae41e4649b934ca495991b7852b855"
      labels:
        
        app: "compat-stateful"
        chart: "contracts"
    spec:
      
      containers:
      - name: "main"
        image: alpine:3
        
        args: 
        - -c
        - sleep 3600
        command: 
        - sh
        ports: 
        - name: http
          containerPort: 8081
  selector: 
    matchLabels:
      
      app: "compat-stateful"
  serviceName: "compat-stateful"
  replicas: 1
---
# Source: contracts/templates/init-helm-apps-library.yaml
# Helm Apps Library: apps-jobs.compat-job
apiVersion: batch/v1
kind: Job
metadata:
  name: "compat-job"
  
  labels:
    
    app: "compat-job"
    chart: "contracts"
spec:
  
  podFailurePolicy:
    rules: []
  template: 
    metadata:
      name: "compat-job"
      
      labels:
        
        app: "compat-job"
        chart: "contracts"
    spec:
      
      containers:
      - name: "main"
        image: alpine:3
        
        args: 
        - -c
        - echo test
        command: 
        - sh
---
# Source: contracts/templates/init-helm-apps-library.yaml
# Helm Apps Library: apps-cronjobs.compat-cron
apiVersion: batch/v1
kind: CronJob
metadata:
  name: "compat-cron"
  
  labels:
    
    app: "compat-cron"
    chart: "contracts"
spec:  
  schedule: "*/10 * * * *"
  failedJobsHistoryLimit: 1
  successfulJobsHistoryLimit: 1
  jobTemplate: 
    
    spec:
      
      template: 
        metadata:
          name: "compat-cron"
          
          labels:
            
            app: "compat-cron"
            chart: "contracts"
        spec:
          
          containers:
          - name: "main"
            image: alpine:3
            
            args: 
            - -c
            - echo cron
            command: 
            - sh
---
# Source: contracts/templates/init-helm-apps-library.yaml
# Helm Apps Library: apps-routes-contract.compat-route
apiVersion: networking.k8s.io/v1
kind: Ingress
metadata:
  name: "compat-route"
  annotations:
    
  labels:
    
    app: "compat-route"
    chart: "contracts"
spec:
  rules:
  - host: "route.example.com"
    http:
      paths:
      - path: /
        pathType: Prefix
        backend:
          service:
            name: compat-service
            port:
              number: 80
---
# Source: contracts/templates/init-helm-apps-library.yaml
# Helm Apps Library: apps-ingresses.compat-ingress
apiVersion: networking.k8s.io/v1
kind: Ingress
metadata:
  name: "compat-ingress"
  annotations:
    
  labels:
    
    app: "compat-ingress"
    chart: "contracts"
spec:
  rules:
  - host: "app.example.com"
    http:
      paths:
      - path: /
        pathType: Prefix
        backend:
          service:
            name: compat-service
            port:
              number: 80
      
  defaultBackend:
    service:
      name: compat-service
      port:
        number: 80
---
# Source: contracts/templates/init-helm-apps-library.yaml
# Source: apps.utils:  fl.expandIncludesInValues
---
# Source: contracts/templates/init-helm-apps-library.yaml
# Helm Apps Library: apps-certificates.compat-certificate

apiVersion: cert-manager.io/v1
kind: Certificate
metadata:
  name: compat-certificate
spec:
  secretName: compat-certificate
  issuerRef:
    kind: ClusterIssuer
    name: letsencrypt
  dnsNames:
  - "compat.example.com"
---
# Source: contracts/templates/init-helm-apps-library.yaml
# Helm Apps Library: apps-network-policies.compat-cilium-netpol
apiVersion: cilium.io/v2
kind: CiliumNetworkPolicy
metadata:
  name: "compat-cilium-netpol"
  
  labels:
    
    app: "compat-cilium-netpol"
    chart: "contracts"
spec:
  endpointSelector:
    matchLabels:
      app: compat-service
  egress:
    - toEndpoints:
        - matchLabels:
            k8s:io.kubernetes.pod.namespace: kube-system
---
# Source: contracts/templates/init-helm-apps-library.yaml
# Helm Apps Library: apps-custom-prometheus-rules.compat-rules
apiVersion: deckhouse.io/v1
kind: CustomPrometheusRules
metadata:
  labels:
    
    app: "compat-rules"
    chart: "contracts"
    component: rules
    prometheus: main
  name: compat-rules
spec:
  groups:
    - name: compat-group
      rules:
        - alert: compat-alert
          expr: vector(1)
          for: 1m
          labels:
            severity_level: "5"
          annotations:
            summary: "compat alert"
---
# Source: contracts/templates/init-helm-apps-library.yaml
# Helm Apps Library: apps-dex-authenticators.compat-dex-auth
apiVersion: deckhouse.io/v1
kind: DexAuthenticator
metadata:
  name: "compat-dex-auth"
  
  labels:
    
    app: "compat-dex-auth"
    chart: "contracts"
spec:
  allowedGroups: 
  - platform-admins
  applicationDomain: "compat.example.com"
  applicationIngressCertificateSecretName: "compat-example-tls"
  applicationIngressClassName: "nginx"
  sendAuthorizationHeader: "true"
---
# Source: contracts/templates/init-helm-apps-library.yaml
# Helm Apps Library: apps-dex-clients.compat-dex-client
apiVersion: deckhouse.io/v1alpha1
kind: DexClient
metadata:
  name: "compat-dex-client"
  
  labels:
    
    app: "compat-dex-client"
    chart: "contracts"
spec:
  redirectURIs: 
  - "https://compat.example.com/callback"
---
# Source: contracts/templates/init-helm-apps-library.yaml
# Helm Apps Library: apps-grafana-dashboards.compat-dashboard
apiVersion: deckhouse.io/v1alpha1
kind: GrafanaDashboardDefinition
metadata:
  name: "compat-dashboard"
  
  labels:
    
    app: "compat-dashboard"
    chart: "contracts"
spec:
  folder: Compatibility
  definition: |
    
    {
      "title": "Compatibility Dashboard",
      "schemaVersion": 36,
      "version": 1,
      "panels": []
    }
---
# Source: contracts/templates/init-helm-apps-library.yaml
# Helm Apps Library: apps-kafka-strimzi.compat-kafka
apiVersion: kafka.strimzi.io/v1beta2
kind: Kafka
metadata:
  name: compat-kafka-production
spec:
  kafkaExporter:
    groupRegex: ".*"
    topicRegex: ".*"
    resources:
      
      limits:
        memory: 128Mi
      requests:
        cpu: 50m
        memory: 128Mi
    template:
      pod:
        metadata:
          labels:
            prometheus.deckhouse.io/custom-target: kafka-exporter
          annotations:
            prometheus.deckhouse.io/port: "9404"
            prometheus.deckhouse.io/sample-limit: "10000"
            
  kafka:
    version: 3.7.0
    replicas: 1
    resources: 
      
      limits:
        memory: 512Mi
      requests:
        cpu: 100m
        memory: 512Mi
    jvmOptions: 
      -Xms: 256m
      -Xmx: 256m
      
    listeners:
    - name: plain
      port: 9092
      type: internal
      tls: false
    - name: tls
      port: 9093
      type: internal
      tls: true
    template:
      pod:
        metadata:
          labels:
            prometheus.deckhouse.io/custom-target: kafka
          annotations:
            prometheus.deckhouse.io/port: "9404"
            prometheus.deckhouse.io/sample-limit: "50000"
        priorityClassName: 
        terminationGracePeriodSeconds: 120
    metricsConfig:
      type: jmxPrometheusExporter
      valueFrom:
        configMapKeyRef:
          name: kafka-metrics
          key: kafka-metrics-config.yml
    config:
      auto.create.topics.enable: "false"
      offsets.topic.replication.factor: 1
      transaction.state.log.replication.factor: 1
      transaction.state.log.min.isr: 1
      log.message.format.version: "2.7"
      inter.broker.protocol.version: "2.7"
    storage:
      type: jbod
      volumes:
      - id: 0
        type: persistent-claim
        size: 1Gi
        class: standard
        deleteClaim: false
  zookeeper:
    priorityClassName: 
    replicas: 1
    resources: 
      
      limits:
        memory: 512Mi
      requests:
        cpu: 100m
        memory: 512Mi
    template:
      pod:
        metadata:
          labels:
            prometheus.deckhouse.io/custom-target: zookeeper
          annotations:
            prometheus.deckhouse.io/port: "9404"
            prometheus.deckhouse.io/sample-limit: "5000"
        priorityClassName: 
        affinity:
          nodeAffinity:
            requiredDuringSchedulingIgnoredDuringExecution:
              nodeSelectorTerms:
                - matchExpressions:
                    - key: kubernetes.io/os
                      operator: In
                      values:
                        - linux
          
          podAntiAffinity:
            requiredDuringSchedulingIgnoredDuringExecution:
            - topologyKey: "kubernetes.io/hostname"
              labelSelector:
                matchLabels:
                  strimzi.io/name: compat-kafka-production-zookeeper
        terminationGracePeriodSeconds: 120
    metricsConfig: 
      type: jmxPrometheusExporter
      valueFrom:
        configMapKeyRef:
          name: kafka-metrics
          key: zookeeper.yml
      
    jvmOptions: 
      -Xms: 256m
      -Xmx: 256m
      
    storage:
      type: persistent-claim
      size: 1Gi
      class: standard
      deleteClaim: false
  entityOperator:
    priorityClassName: 
    template:
      pod:
        metadata:
          labels:
            apps-kafka-strimzi: entity-operator
        priorityClassName: 
    topicOperator:
      resources: 
        
        limits:
          memory: 256Mi
        requests:
          cpu: 50m
          memory: 256Mi
    userOperator:
      resources: 
        
        limits:
          memory: 256Mi
        requests:
          cpu: 50m
          memory: 256Mi
---
# Source: contracts/templates/init-helm-apps-library.yaml
apiVersion: kafka.strimzi.io/v1beta1
kind: KafkaTopic
metadata:
  name: compat-topic
  labels:
    strimzi.io/cluster: compat-kafka-production
spec:
  topicName: compat-topic
  partitions: 1
  replicas: 1
  config:
    retention.ms: 60000
    segment.bytes: 1.048576e+06
    min.insync.replicas: 1
---
# Source: contracts/templates/init-helm-apps-library.yaml
# Helm Apps Library: apps-k8s-manifests.compat-generic-lease

apiVersion: coordination.k8s.io/v1
kind: Lease
metadata:
  name: "compat-generic-lease"
  
  labels:
    
    app: "compat-generic-lease"
    chart: "contracts"

  namespace: compat




spec:

  holderIdentity: compat-controller
  leaseDurationSeconds: 30
  renewTime: "2025-01-01T00:00:00Z"
---
# Source: contracts/templates/init-helm-apps-library.yaml
# Helm Apps Library: apps-infra.node-groups.compat-group
apiVersion: deckhouse.io/v1
kind: NodeGroup
metadata:
  name: "compat-group"
  annotations:
    
  labels:
    
spec:
---
# Source: contracts/templates/init-helm-apps-library.yaml
# Helm Apps Library: apps-infra.node-users.compat-user
apiVersion: deckhouse.io/v1
kind: NodeUser
metadata:
  name: "compat-user"
  annotations:
    owner: platform
    
  labels:
    team: platform
    
spec:  
  uid: 2001
  isSudoer: true
---
# Source: contracts/templates/init-helm-apps-library.yaml
# Helm Apps Library: apps-k8s-manifests.compat-generic-validating-webhook

apiVersion: admissionregistration.k8s.io/v1
kind: ValidatingWebhookConfiguration
metadata:
  name: "compat-generic-validating-webhook"
  
  labels:
    
    app: "compat-generic-validating-webhook"
    chart: "contracts"





webhooks:

  - admissionReviewVersions:
    - v1
    clientConfig:
      service:
        name: compat-webhook
        namespace: compat
        path: /validate
        port: 443
    failurePolicy: Ignore
    name: validate.compat.example.com
    namespaceSelector:
      matchLabels:
        kubernetes.io/metadata.name: compat
    rules:
    - apiGroups:
      - ""
      apiVersions:
      - v1
      operations:
      - CREATE
      - UPDATE
      resources:
      - pods
    sideEffects: None
---
# Source: contracts/templates/init-helm-apps-library.yaml
---
# Helm Apps Library: apps-cronjobs.compat-cron.verticalPodAutoscaler
apiVersion: autoscaling.k8s.io/v1
kind: VerticalPodAutoscaler
metadata:
  name: "compat-cron"
  
  labels:
    
    app: "compat-cron"
    chart: "contracts"
spec:
  targetRef:
    apiVersion: "batch/v1"
    kind: CronJob
    name: "compat-cron"
  updatePolicy:
    updateMode: "Off"
  resourcePolicy: {}
---
# Source: contracts/templates/init-helm-apps-library.yaml
---
# Helm Apps Library: apps-jobs.compat-job.verticalPodAutoscaler
apiVersion: autoscaling.k8s.io/v1
kind: VerticalPodAutoscaler
metadata:
  name: "compat-job"
  
  labels:
    
    app: "compat-job"
    chart: "contracts"
spec:
  targetRef:
    apiVersion: "batch/v1"
    kind: Job
    name: "compat-job"
  updatePolicy:
    updateMode: "Off"
  resourcePolicy: {}
---
# Source: contracts/templates/init-helm-apps-library.yaml
apiVersion: autoscaling.k8s.io/v1
kind: VerticalPodAutoscaler
metadata:
  name: compat-kafka-production-kafka
spec:
  targetRef:
    apiVersion: "apps/v1"
    kind: StatefulSet
    name: compat-kafka-production-kafka
  updatePolicy:
    updateMode: "Off"
---
# Source: contracts/templates/init-helm-apps-library.yaml
apiVersion: autoscaling.k8s.io/v1
kind: VerticalPodAutoscaler
metadata:
  name: compat-kafka-production-zookeeper
spec:
  targetRef:
    apiVersion: "apps/v1"
    kind: StatefulSet
    name: compat-kafka-production-zookeeper
  updatePolicy:
    updateMode: "Off"
---
# Source: contracts/templates/init-helm-apps-library.yaml
apiVersion: autoscaling.k8s.io/v1
kind: VerticalPodAutoscaler
metadata:
  name: compat-kafka-production-entity-operator
spec:
  targetRef:
    apiVersion: "apps/v1"
    kind: Deployment
    name: compat-kafka-production-entity-operator
  updatePolicy:
    updateMode: "Off"
---
# Source: contracts/templates/init-helm-apps-library.yaml
apiVersion: autoscaling.k8s.io/v1
kind: VerticalPodAutoscaler
metadata:
  name: compat-kafka-production-kafka-exporter
spec:
  targetRef:
    apiVersion: "apps/v1"
    kind: Deployment
    name: compat-kafka-production-kafka-exporter
  updatePolicy:
    updateMode: "Off"
---
# Source: contracts/templates/init-helm-apps-library.yaml
# Helm Apps Library: apps-k8s-manifests.compat-generic-cr

apiVersion: example.io/v1alpha1
kind: WidgetPolicy
metadata:
  name: "compat-generic-cr"
  
  annotations:
    importer/source-chart: "kube-prometheus-stack"
  labels:
    
    app: "compat-generic-cr"
    chart: "contracts"

  namespace: compat




spec:

  rules:
  - action: allow
    port: 9090
  selector:
    matchLabels:
      app: compat-service


status:

  observedGeneration: 1
