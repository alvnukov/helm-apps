---
# Source: tests/templates/init-helm-apps-library.yaml
apiVersion: cert-manager.io/v1
kind: Certificate
metadata:
  annotations: {}
  labels: {}
  name: custom-certificate-1
spec:
  dnsNames:
  - example.org
  - example-1.org
  - example-2.org
  issuerRef:
    kind: ClusterIssuer
    name: letsencrypt
  secretName: custom-certificate-1
---
# Source: tests/templates/init-helm-apps-library.yaml
apiVersion: cert-manager.io/v1
kind: Certificate
metadata:
  annotations: {}
  labels: {}
  name: custom-issuer-1
spec:
  dnsNames:
  - example.org
  - example-1.org
  - example-2.org
  issuerRef:
    kind: ClusterIssuer
    name: customIssuer
  secretName: custom-issuer-1
---
# Source: tests/templates/init-helm-apps-library.yaml
apiVersion: cert-manager.io/v1
kind: Certificate
metadata:
  annotations: {}
  labels: {}
  name: ingress-3
spec:
  dnsNames:
  - example.org
  issuerRef:
    kind: ClusterIssuer
    name: letsencrypt
  secretName: ingress-3
---
# Source: tests/templates/init-helm-apps-library.yaml
apiVersion: cert-manager.io/v1
kind: Certificate
metadata:
  annotations: {}
  labels: {}
  name: ingress-dex-auth
spec:
  dnsNames:
  - example.org
  issuerRef:
    kind: ClusterIssuer
    name: letsencrypt
  secretName: ingress-dex-auth
---
# Source: tests/templates/init-helm-apps-library.yaml
apiVersion: cert-manager.io/v1
kind: Certificate
metadata:
  annotations: {}
  labels: {}
  name: nginx
spec:
  dnsNames:
  - example.com
  issuerRef:
    kind: ClusterIssuer
    name: letsencrypt
  secretName: nginx
---
# Source: tests/templates/init-helm-apps-library.yaml
apiVersion: rbac.authorization.k8s.io/v1
kind: ClusterRole
metadata:
  annotations:
    helm-apps/version: TEST
  labels:
    app: test-app-2
    chart: tests
    repo: ""
  name: test-app-2:prometheus-access
rules:
- apiGroups:
  - monitoring.coreos.com
  resourceNames:
  - main
  - longterm
  resources:
  - prometheuses/http
  verbs:
  - get
---
# Source: tests/templates/init-helm-apps-library.yaml
apiVersion: rbac.authorization.k8s.io/v1
kind: ClusterRole
metadata:
  annotations:
    helm-apps/version: TEST
  labels:
    app: test-app
    chart: tests
    repo: ""
  name: test-app:prometheus-access
rules:
- apiGroups:
  - monitoring.coreos.com
  resourceNames:
  - main
  - longterm
  resources:
  - prometheuses/http
  verbs:
  - get
---
# Source: tests/templates/init-helm-apps-library.yaml
apiVersion: rbac.authorization.k8s.io/v1
kind: ClusterRoleBinding
metadata:
  annotations:
    helm-apps/version: TEST
  labels:
    app: test-app-2
    chart: tests
    repo: ""
  name: test-app-2:prometheus-access
roleRef:
  apiGroup: rbac.authorization.k8s.io
  kind: ClusterRole
  name: test-app-2:prometheus-access
subjects:
- kind: ServiceAccount
  name: test-app-2
  namespace: test-prod
---
# Source: tests/templates/init-helm-apps-library.yaml
apiVersion: rbac.authorization.k8s.io/v1
kind: ClusterRoleBinding
metadata:
  annotations:
    helm-apps/version: TEST
  labels:
    app: test-app
    chart: tests
    repo: ""
  name: test-app:prometheus-access
roleRef:
  apiGroup: rbac.authorization.k8s.io
  kind: ClusterRole
  name: test-app:prometheus-access
subjects:
- kind: ServiceAccount
  name: test-app
  namespace: test-prod
---
# Source: tests/templates/init-helm-apps-library.yaml
apiVersion: v1
data:
  nginx.conf: |
    configline1
    configline2
kind: ConfigMap
metadata:
  annotations:
    helm-apps/version: TEST
    testAnnotation: testVal
  labels:
    app: app-1
    chart: tests
    repo: ""
  name: config-containers-app-1-container-1-nginx-conf
---
# Source: tests/templates/init-helm-apps-library.yaml
apiVersion: v1
data:
  nginx.conf: |
    configline1
    configline2
kind: ConfigMap
metadata:
  annotations:
    helm-apps/version: TEST
    testAnnotation: testVal
  labels:
    app: app-1
    chart: tests
    repo: ""
  name: config-containers-app-1-container-1-nginx-conf
---
# Source: tests/templates/init-helm-apps-library.yaml
apiVersion: v1
data:
  nginx.conf: |
    configline1
    configline2
kind: ConfigMap
metadata:
  annotations:
    helm-apps/version: TEST
    testAnnotation: testVal
  labels:
    app: cronjob-1
    chart: tests
    repo: ""
  name: config-containers-cronjob-1-container-1-nginx-conf
---
# Source: tests/templates/init-helm-apps-library.yaml
apiVersion: v1
data:
  conf: |
    test
kind: ConfigMap
metadata:
  annotations:
    helm-apps/version: TEST
  labels:
    app: env-yaml-app
    chart: tests
    repo: ""
  name: config-containers-env-yaml-app-test-conf
---
# Source: tests/templates/init-helm-apps-library.yaml
apiVersion: v1
data:
  nginx.conf: |
    configline1
    configline2
kind: ConfigMap
metadata:
  annotations:
    helm-apps/version: TEST
    testAnnotation: testVal
  labels:
    app: job-1
    chart: tests
    repo: ""
  name: config-containers-job-1-container-1-nginx-conf
---
# Source: tests/templates/init-helm-apps-library.yaml
apiVersion: v1
data:
  default.conf: |
    server {
      listen         80 default_server;
      listen         [::]:80 default_server;
      server_name    example.com example.com;
      root           /var/www/example.com;
      index          index.html;
      try_files $uri /index.html;
      location / {
        proxy_set_header Authorization "Bearer ${SECRET_TOKEN}";
        proxy_pass_header Authorization;
        proxy_pass https://backend:3000;
      }
    }
kind: ConfigMap
metadata:
  annotations:
    helm-apps/version: TEST
  labels:
    app: nginx
    chart: tests
    repo: ""
  name: config-containers-nginx-nginx-default-conf
---
# Source: tests/templates/init-helm-apps-library.yaml
apiVersion: v1
data:
  nginx.conf: |
    configline1
kind: ConfigMap
metadata:
  annotations:
    helm-apps/version: TEST
    testAnnotation: testVal
  labels:
    app: app-1
    chart: tests
    repo: ""
  name: config-initcontainers-app-1-init-container-1-nginx-conf
---
# Source: tests/templates/init-helm-apps-library.yaml
apiVersion: v1
data:
  nginx.conf: |
    configline1
kind: ConfigMap
metadata:
  annotations:
    helm-apps/version: TEST
    testAnnotation: testVal
  labels:
    app: app-1
    chart: tests
    repo: ""
  name: config-initcontainers-app-1-init-container-1-nginx-conf
---
# Source: tests/templates/init-helm-apps-library.yaml
apiVersion: v1
data:
  nginx.conf: |
    configline1
kind: ConfigMap
metadata:
  annotations:
    helm-apps/version: TEST
    testAnnotation: testVal
  labels:
    app: cronjob-1
    chart: tests
    repo: ""
  name: config-initcontainers-cronjob-1-init-container-1-nginx-conf
---
# Source: tests/templates/init-helm-apps-library.yaml
apiVersion: v1
data:
  nginx.conf: |
    configline1
kind: ConfigMap
metadata:
  annotations:
    helm-apps/version: TEST
    testAnnotation: testVal
  labels:
    app: job-1
    chart: tests
    repo: ""
  name: config-initcontainers-job-1-init-container-1-nginx-conf
---
# Source: tests/templates/init-helm-apps-library.yaml
apiVersion: v1
data:
  config: |
    level1:
      testMap:
        testProd2: 2v
      testMap2:
        test: 2v
        test2: 3v
        test3: 3
        testNestedMap:
          nestedMap:
            prod: 1
            test: 1
      testSlice:
      - testProd
      - testProd2
    overwrited: default value from values.yaml
    testIncludeVar: prod value from file
    testIncludeVarMustOverwrited: prod value from values.yaml
    testValue: value from file
    testValueWithDefault: default value from file
kind: ConfigMap
metadata:
  annotations:
    helm-apps/version: TEST
  labels:
    app: env-yaml-app
    chart: tests
    repo: ""
  name: config-yaml-containers-env-yaml-app-test-config
---
# Source: tests/templates/init-helm-apps-library.yaml
apiVersion: v1
binaryData:
  test.gz: jdbkjbkjsdbkjdbjdsbljl
data:
  TEST1: val1
  TEST2: val2
  nginx.conf2: |
    configline1
    configline2
  something.conf: |
    configline1
kind: ConfigMap
metadata:
  annotations:
    helm-apps/version: TEST
  labels:
    app: configmap-1
    chart: tests
    repo: ""
  name: configmap-1
---
# Source: tests/templates/init-helm-apps-library.yaml
apiVersion: v1
data:
  nginx.conf: |
    configline1
    configline2
kind: ConfigMap
metadata:
  annotations:
    helm-apps/version: TEST
  labels:
    app: configmap-2
    chart: tests
    repo: ""
  name: configmap-2
---
# Source: tests/templates/init-helm-apps-library.yaml
apiVersion: batch/v1beta1
kind: CronJob
metadata:
  annotations:
    helm-apps/version: TEST
    testAnnotation: testVal
  labels:
    app: cronjob-1
    chart: tests
    repo: ""
  name: cronjob-1
spec:
  concurrencyPolicy: Allow
  failedJobsHistoryLimit: 1
  jobTemplate:
    spec:
      activeDeadlineSeconds: 1800
      backoffLimit: 0
      template:
        metadata:
          annotations:
            testAnnotation: testVal
          labels:
            app: cronjob-1
            chart: tests
            repo: ""
          name: cronjob-1
        spec:
          activeDeadlineSeconds: 1800
          affinity:
            podAntiAffinity:
              preferredDuringSchedulingIgnoredDuringExecution:
              - podAffinityTerm:
                  labelSelector:
                    matchLabels:
                      app: cronjob-1
                      chart: tests
                      repo: ""
                  topologyKey: kubernetes.io/hostname
                weight: 10
          containers:
          - args:
            - -f
            - /dev/null
            command:
            - tail
            env:
            - name: TEST1
              value: val1
            - name: TEST2
              value: val2
            envFrom:
            - configMapRef:
                name: env-configmap
            - secretRef:
                name: envs-containers-cronjob-1-container-1
            image: alpine:3
            lifecycle:
              preStop:
                exec:
                  command:
                  - /usr/sbin/nginx
                  - -s
                  - quit
            name: container-1
            resources:
              limits:
                memory: 200Mi
              requests:
                cpu: 100m
                memory: 200Mi
            volumeMounts:
            - mountPath: /cache
              name: cache-volume
            - mountPath: /etc/nginx/nginx.conf
              name: config-containers-cronjob-1-container-1-nginx-conf
              subPath: nginx.conf
            - mountPath: /etc/secret.conf
              name: config-containers-cronjob-1-container-1-secret-conf
              subPath: secret.conf
          imagePullSecrets:
          - name: registrysecret
          initContainers:
          - args:
            - -f
            - /dev/null
            command:
            - tail
            env:
            - name: TEST1
              value: val1
            envFrom:
            - configMapRef:
                name: env-configmap
            - secretRef:
                name: envs-initcontainers-cronjob-1-init-container-1
            image: alpine:3
            lifecycle:
              preStop:
                exec:
                  command:
                  - /usr/sbin/nginx
                  - -s
                  - quit
            name: init-container-1
            resources:
              limits:
                memory: 200Mi
              requests:
                cpu: 100m
                memory: 200Mi
            volumeMounts:
            - mountPath: /cache
              name: cache-volume
            - mountPath: /etc/nginx/nginx.conf
              name: config-initcontainers-cronjob-1-init-container-1-nginx-conf
              subPath: nginx.conf
            - mountPath: /etc/secret.conf
              name: config-initcontainers-cronjob-1-init-container-1-secret-conf
              subPath: secret.conf
          priorityClassName: production-medium
          restartPolicy: Never
          tolerations:
          - key: something
            operator: Equal
            value: somethingelse
          volumes:
          - emptyDir: {}
            name: cache-volume
          - configMap:
              name: config-initcontainers-cronjob-1-init-container-1-nginx-conf
            name: config-initcontainers-cronjob-1-init-container-1-nginx-conf
          - name: config-initcontainers-cronjob-1-init-container-1-secret-conf
            secret:
              secretName: config-initcontainers-cronjob-1-init-container-1-secret-conf
          - configMap:
              name: config-containers-cronjob-1-container-1-nginx-conf
            name: config-containers-cronjob-1-container-1-nginx-conf
          - name: config-containers-cronjob-1-container-1-secret-conf
            secret:
              secretName: config-containers-cronjob-1-container-1-secret-conf
  schedule: 0 * * * *
  startingDeadlineSeconds: 60
  successfulJobsHistoryLimit: 1
---
# Source: tests/templates/init-helm-apps-library.yaml
apiVersion: deckhouse.io/v1
kind: CustomPrometheusRules
metadata:
  annotations: {}
  labels:
    component: rules
    prometheus: main
  name: test-rule
spec:
  groups:
  - name: test-group
    rules:
    - alert: sentry-kafka-lag
      annotations:
        description: Too many unprocessed messages in sentry in kafka in a topic
        plk_labels_as_annotations: pod,instance
        plk_markup_format: markdown
        plk_protocol_version: "1"
        summary: |-
          Слишком много не обработанных сообщений в топиках kafka sentry
          Проверить работу consumer топика
      expr: sum(kafka_consumergroup_lag{}) by (consumergroup, topic) > 50000
      for: 5m
      labels:
        severity_level: "3"
    - alert: test-alert
      annotations:
        description: Too many unprocessed messages in sentry in kafka in a topic
        plk_labels_as_annotations: pod,instance
        plk_markup_format: markdown
        plk_protocol_version: "1"
        summary: |-
          Слишком много не обработанных сообщений в топиках kafka sentry
          Проверить работу consumer топика
      expr: sum(kafka_consumergroup_lag{}) by (consumergroup, topic) > 10000
      for: 5m
      labels:
        severity_level: "4"
---
# Source: tests/templates/init-helm-apps-library.yaml
apiVersion: apps/v1
kind: Deployment
metadata:
  annotations:
    checksum/config: 14aeb92c2c444a2623279fd0cf52ac8522bf5485f312a111a64b1a112a5beaad
    helm-apps/version: TEST
    testAnnotation: testVal
  labels:
    app: app-1
    chart: tests
    repo: ""
    testLabel: testVal
  name: app-1
spec:
  replicas: 2
  revisionHistoryLimit: 3
  selector:
    matchLabels:
      app: app-1
  strategy:
    rollingUpdate:
      maxSurge: 25%
      maxUnavailable: 25%
    type: RollingUpdate
  template:
    metadata:
      annotations:
        checksum/config: 14aeb92c2c444a2623279fd0cf52ac8522bf5485f312a111a64b1a112a5beaad
        testAnnotation: testVal
      labels:
        app: app-1
        chart: tests
        repo: ""
        testLabel: testVal
      name: app-1
    spec:
      affinity:
        podAntiAffinity:
          preferredDuringSchedulingIgnoredDuringExecution:
          - podAffinityTerm:
              labelSelector:
                matchLabels:
                  app: app-1
                  chart: tests
                  repo: ""
              topologyKey: kubernetes.io/hostname
            weight: 10
      containers:
      - args:
        - -f
        - /dev/null
        command:
        - tail
        env:
        - name: TEST1
          value: val1
        - name: TEST2
          value: val2
        - name: APP_ENV_NAME_2
          valueFrom:
            secretKeyRef:
              key: SECRET_ENV_NAME_2
              name: secret-1
        envFrom:
        - configMapRef:
            name: env-configmap
        - secretRef:
            name: envs-containers-app-1-container-1
        image: alpine:3
        lifecycle:
          preStop:
            exec:
              command:
              - /usr/sbin/nginx
              - -s
              - quit
        livenessProbe:
          httpGet:
            path: /liveness
            port: 80
        name: container-1
        ports:
        - containerPort: 80
          name: http
        readinessProbe:
          httpGet:
            path: /readiness
            port: 80
        resources:
          limits:
            ephemeral-storage: 1024Mi
            memory: 200Mi
          requests:
            cpu: 100m
            ephemeral-storage: 1024Mi
            memory: 200Mi
        startupProbe:
          httpGet:
            path: /startup
            port: 80
        volumeMounts:
        - mountPath: /cache
          name: cache-volume
        - mountPath: /etc/nginx/nginx.conf
          name: config-containers-app-1-container-1-nginx-conf
          subPath: nginx.conf
        - mountPath: /etc/nginx/nginx2.conf
          name: config-containers-app-1-container-1-nginx-conf2
          subPath: nginx.conf2
        - mountPath: /etc/secret.conf
          name: config-containers-app-1-container-1-secret-conf
          subPath: secret.conf
      dnsPolicy: ClusterFirstWithHostNet
      hostNetwork: true
      imagePullSecrets:
      - name: registrysecret
      initContainers:
      - args:
        - -f
        - /dev/null
        command:
        - tail
        env:
        - name: TEST1
          value: val1
        envFrom:
        - configMapRef:
            name: env-configmap
        - secretRef:
            name: envs-initcontainers-app-1-init-container-1
        image: alpine:3
        lifecycle:
          preStop:
            exec:
              command:
              - /usr/sbin/nginx
              - -s
              - quit
        name: init-container-1
        resources:
          limits:
            memory: 200Mi
          requests:
            cpu: 100m
            memory: 200Mi
        volumeMounts:
        - mountPath: /cache
          name: cache-volume
        - mountPath: /etc/nginx/nginx.conf
          name: config-initcontainers-app-1-init-container-1-nginx-conf
          subPath: nginx.conf
        - mountPath: /etc/secret.conf
          name: config-initcontainers-app-1-init-container-1-secret-conf
          subPath: secret.conf
      priorityClassName: production-medium
      terminationGracePeriodSeconds: 30
      tolerations:
      - key: something
        operator: Equal
        value: somethingelse
      volumes:
      - emptyDir: {}
        name: cache-volume
      - configMap:
          name: config-initcontainers-app-1-init-container-1-nginx-conf
        name: config-initcontainers-app-1-init-container-1-nginx-conf
      - name: config-initcontainers-app-1-init-container-1-secret-conf
        secret:
          secretName: config-initcontainers-app-1-init-container-1-secret-conf
      - configMap:
          name: config-containers-app-1-container-1-nginx-conf
        name: config-containers-app-1-container-1-nginx-conf
      - configMap:
          name: configmap-1
        name: config-containers-app-1-container-1-nginx-conf2
      - name: config-containers-app-1-container-1-secret-conf
        secret:
          secretName: config-containers-app-1-container-1-secret-conf
---
# Source: tests/templates/init-helm-apps-library.yaml
apiVersion: apps/v1
kind: Deployment
metadata:
  annotations:
    checksum/config: e3b0c44298fc1c149afbf4c8996fb92427ae41e4649b934ca495991b7852b855
    helm-apps/version: TEST
  labels:
    app: app-for-test-from-secrets-env-vars
    chart: tests
    repo: ""
  name: app-for-test-from-secrets-env-vars
spec:
  revisionHistoryLimit: 3
  selector:
    matchLabels:
      app: app-for-test-from-secrets-env-vars
  strategy:
    rollingUpdate:
      maxSurge: 20%
      maxUnavailable: 25%
    type: RollingUpdate
  template:
    metadata:
      annotations:
        checksum/config: e3b0c44298fc1c149afbf4c8996fb92427ae41e4649b934ca495991b7852b855
      labels:
        app: app-for-test-from-secrets-env-vars
        chart: tests
        repo: ""
      name: app-for-test-from-secrets-env-vars
    spec:
      containers:
      - env:
        - name: APP_ENV_NAME_1
          valueFrom:
            secretKeyRef:
              key: SECRET_ENV_NAME_1
              name: secret-1
        - name: APP_ENV_NAME_2
          valueFrom:
            secretKeyRef:
              key: SECRET_ENV_NAME_2
              name: secret-1
        image: test:1
        name: main
      imagePullSecrets:
      - name: registrysecret
      priorityClassName: production-medium
---
# Source: tests/templates/init-helm-apps-library.yaml
apiVersion: apps/v1
kind: Deployment
metadata:
  annotations:
    checksum/config: e3b0c44298fc1c149afbf4c8996fb92427ae41e4649b934ca495991b7852b855
    helm-apps/version: TEST
  labels:
    app: app-with-deckhouse-metrics
    chart: tests
    repo: ""
  name: app-with-deckhouse-metrics
spec:
  revisionHistoryLimit: 3
  selector:
    matchLabels:
      app: app-with-deckhouse-metrics
  strategy:
    rollingUpdate:
      maxSurge: 20%
      maxUnavailable: 25%
    type: RollingUpdate
  template:
    metadata:
      annotations:
        checksum/config: e3b0c44298fc1c149afbf4c8996fb92427ae41e4649b934ca495991b7852b855
      labels:
        app: app-with-deckhouse-metrics
        chart: tests
        repo: ""
      name: app-with-deckhouse-metrics
    spec:
      containers:
      - env:
        - name: test
          value: test
        image: REPO:TAG
        name: main
      imagePullSecrets:
      - name: registrysecret
      priorityClassName: production-medium
---
# Source: tests/templates/init-helm-apps-library.yaml
apiVersion: apps/v1
kind: Deployment
metadata:
  annotations:
    checksum/config: f0b89172b9c460ce9fe6c12abe9d5a02d3210d97827b134b7d04abf3c499c822
    helm-apps/version: TEST
  labels:
    app: env-yaml-app
    chart: tests
    repo: ""
  name: env-yaml-app
spec:
  revisionHistoryLimit: 3
  selector:
    matchLabels:
      app: env-yaml-app
  strategy:
    rollingUpdate:
      maxSurge: 20%
      maxUnavailable: 25%
    type: RollingUpdate
  template:
    metadata:
      annotations:
        checksum/config: f0b89172b9c460ce9fe6c12abe9d5a02d3210d97827b134b7d04abf3c499c822
      labels:
        app: env-yaml-app
        chart: tests
        repo: ""
      name: env-yaml-app
    spec:
      containers:
      - env:
        - name: ALTER_NAME_YAML
          value: default value
        - name: TESTAPP_LEVEL1_LEVEL2_TEST
          value: default value
        - name: TESTAPP_LEVEL1_TESTENV3
          value: from envYAML
        - name: TESTAPP_LEVEL1_TESTENV4
          value: prod value from envVars
        envFrom:
        - secretRef:
            name: envs-containers-env-yaml-app-test
        image: null
        name: test
        volumeMounts:
        - mountPath: /config
          name: config-containers-env-yaml-app-test-conf
          subPath: conf
        - mountPath: /config
          name: config-yaml-containers-env-yaml-app-test-config
          subPath: config
      imagePullSecrets:
      - name: registrysecret
      priorityClassName: production-medium
      volumes:
      - configMap:
          name: config-containers-env-yaml-app-test-conf
        name: config-containers-env-yaml-app-test-conf
      - configMap:
          name: config-yaml-containers-env-yaml-app-test-config
        name: config-yaml-containers-env-yaml-app-test-config
---
# Source: tests/templates/init-helm-apps-library.yaml
apiVersion: apps/v1
kind: Deployment
metadata:
  annotations:
    checksum/config: e3b0c44298fc1c149afbf4c8996fb92427ae41e4649b934ca495991b7852b855
    helm-apps/version: TEST
  labels:
    app: hpa-app
    chart: tests
    repo: ""
  name: hpa-app
spec:
  revisionHistoryLimit: 3
  selector:
    matchLabels:
      app: my-selector
  strategy:
    rollingUpdate:
      maxSurge: 20%
      maxUnavailable: 25%
    type: RollingUpdate
  template:
    metadata:
      annotations:
        checksum/config: e3b0c44298fc1c149afbf4c8996fb92427ae41e4649b934ca495991b7852b855
      labels:
        app: hpa-app
        chart: tests
        repo: ""
      name: hpa-app
    spec:
      containers:
      - env:
        - name: test
          value: test
        image: test:1
        name: main
      imagePullSecrets:
      - name: registrysecret
      priorityClassName: production-medium
---
# Source: tests/templates/init-helm-apps-library.yaml
apiVersion: apps/v1
kind: Deployment
metadata:
  annotations:
    checksum/config: e3b0c44298fc1c149afbf4c8996fb92427ae41e4649b934ca495991b7852b855
    helm-apps/version: TEST
  labels:
    app: minimum-app
    chart: tests
    repo: ""
  name: minimum-app
spec:
  revisionHistoryLimit: 3
  selector:
    matchLabels:
      app: minimum-app
  strategy:
    rollingUpdate:
      maxSurge: 20%
      maxUnavailable: 25%
    type: RollingUpdate
  template:
    metadata:
      annotations:
        checksum/config: e3b0c44298fc1c149afbf4c8996fb92427ae41e4649b934ca495991b7852b855
      labels:
        app: minimum-app
        chart: tests
        repo: ""
      name: minimum-app
    spec:
      containers:
      - command:
        - tail
        image: alpine:3
        name: container-1
      imagePullSecrets:
      - name: registrysecret
      priorityClassName: production-medium
---
# Source: tests/templates/init-helm-apps-library.yaml
apiVersion: apps/v1
kind: Deployment
metadata:
  annotations:
    checksum/config: 19812d5210967fd69097dc991263af171c4071ebb455357bd49be2a0ca05acdd
    helm-apps/version: TEST
  labels:
    app: nginx
    chart: tests
    repo: ""
  name: nginx
spec:
  replicas: 1
  revisionHistoryLimit: 3
  selector:
    matchLabels:
      app: nginx
  strategy:
    rollingUpdate:
      maxSurge: 20%
      maxUnavailable: 25%
    type: RollingUpdate
  template:
    metadata:
      annotations:
        checksum/config: 19812d5210967fd69097dc991263af171c4071ebb455357bd49be2a0ca05acdd
      labels:
        app: nginx
        chart: tests
        repo: ""
      name: nginx
    spec:
      containers:
      - envFrom:
        - secretRef:
            name: envs-containers-nginx-nginx
        image: REPO:TAG
        name: nginx
        ports:
        - containerPort: 80
          name: http
        volumeMounts:
        - mountPath: /etc/nginx/templates/default.conf.template
          name: config-containers-nginx-nginx-default-conf
          subPath: default.conf
      imagePullSecrets:
      - name: registrysecret
      priorityClassName: production-medium
      volumes:
      - configMap:
          name: config-containers-nginx-nginx-default-conf
        name: config-containers-nginx-nginx-default-conf
---
# Source: tests/templates/init-helm-apps-library.yaml
apiVersion: apps/v1
kind: Deployment
metadata:
  annotations:
    checksum/config: e3b0c44298fc1c149afbf4c8996fb92427ae41e4649b934ca495991b7852b855
    helm-apps/version: TEST
  labels:
    app: pod-disruption-budget-integer
    chart: tests
    repo: ""
  name: pod-disruption-budget-integer
spec:
  replicas: 2
  revisionHistoryLimit: 3
  selector:
    matchLabels:
      app: pod-disruption-budget-integer
  strategy:
    rollingUpdate:
      maxSurge: 20%
      maxUnavailable: 25%
    type: RollingUpdate
  template:
    metadata:
      annotations:
        checksum/config: e3b0c44298fc1c149afbf4c8996fb92427ae41e4649b934ca495991b7852b855
      labels:
        app: pod-disruption-budget-integer
        chart: tests
        repo: ""
      name: pod-disruption-budget-integer
    spec:
      containers:
      - command:
        - tail
        image: alpine:3
        name: container-1
      imagePullSecrets:
      - name: registrysecret
      priorityClassName: production-medium
---
# Source: tests/templates/init-helm-apps-library.yaml
apiVersion: apps/v1
kind: Deployment
metadata:
  annotations:
    checksum/config: e3b0c44298fc1c149afbf4c8996fb92427ae41e4649b934ca495991b7852b855
    helm-apps/version: TEST
  labels:
    app: test-app
    chart: tests
    repo: ""
  name: test-app
spec:
  revisionHistoryLimit: 3
  selector:
    matchLabels:
      app: test-app
  strategy:
    rollingUpdate:
      maxSurge: 20%
      maxUnavailable: 25%
    type: RollingUpdate
  template:
    metadata:
      annotations:
        checksum/config: e3b0c44298fc1c149afbf4c8996fb92427ae41e4649b934ca495991b7852b855
      labels:
        app: test-app
        chart: tests
        repo: ""
      name: test-app
    spec:
      containers:
      - env:
        - name: test
          value: test
        image: test:1
        name: main
      imagePullSecrets:
      - name: registrysecret
      priorityClassName: production-medium
      serviceAccountName: test-app
---
# Source: tests/templates/init-helm-apps-library.yaml
apiVersion: apps/v1
kind: Deployment
metadata:
  annotations:
    checksum/config: e3b0c44298fc1c149afbf4c8996fb92427ae41e4649b934ca495991b7852b855
    helm-apps/version: TEST
  labels:
    app: test-app-2
    chart: tests
    repo: ""
  name: test-app-2
spec:
  revisionHistoryLimit: 3
  selector:
    matchLabels:
      app: test-app-2
  strategy:
    rollingUpdate:
      maxSurge: 20%
      maxUnavailable: 25%
    type: RollingUpdate
  template:
    metadata:
      annotations:
        checksum/config: e3b0c44298fc1c149afbf4c8996fb92427ae41e4649b934ca495991b7852b855
      labels:
        app: test-app-2
        chart: tests
        repo: ""
      name: test-app-2
    spec:
      containers:
      - env:
        - name: test
          value: test
        image: test:1
        name: main
      imagePullSecrets:
      - name: registrysecret
      priorityClassName: production-medium
      serviceAccountName: test-app-2
---
# Source: tests/templates/init-helm-apps-library.yaml
apiVersion: apps/v1
kind: Deployment
metadata:
  annotations:
    checksum/config: e3b0c44298fc1c149afbf4c8996fb92427ae41e4649b934ca495991b7852b855
    helm-apps/version: TEST
  labels:
    app: test-app-stateless
    chart: tests
    repo: ""
  name: test-app-stateless
spec:
  selector:
    matchLabels:
      app: test-app-stateless
  template:
    metadata:
      annotations:
        checksum/config: e3b0c44298fc1c149afbf4c8996fb92427ae41e4649b934ca495991b7852b855
      labels:
        app: test-app-stateless
        chart: tests
        repo: ""
      name: test-app-stateless
    spec:
      containers:
      - env:
        - name: defaultTest
          value: default
        - name: notRegex
          value: testDefault
        - name: regexEnv
          value: defaultError
        image: REPO:TAG
        name: main
      imagePullSecrets:
      - name: registrysecret
---
# Source: tests/templates/init-helm-apps-library.yaml
apiVersion: deckhouse.io/v1
kind: DexAuthenticator
metadata:
  annotations:
    helm-apps/version: TEST
  labels:
    app: ingress-dex-auth
    chart: tests
    repo: ""
  name: ingress-dex-auth
spec:
  applicationDomain: example.org
  applicationIngressCertificateSecretName: ingress-dex-auth
  applicationIngressClassName: nginx
---
# Source: tests/templates/init-helm-apps-library.yaml
apiVersion: autoscaling/v2beta2
kind: HorizontalPodAutoscaler
metadata:
  annotations:
    helm-apps/version: TEST
    testAnnotation: testVal
  labels:
    app: app-1
    chart: tests
    repo: ""
  name: app-1
spec:
  behavior:
    scaleDown:
      policies:
      - periodSeconds: 60
        type: Percent
        value: 10
  maxReplicas: 1
  metrics:
  - object:
      describedObject:
        apiVersion: v1
        kind: Service
        name: app-1
      metric:
        name: metric-1
      target:
        type: Value
        value: 10000m
    type: Object
  minReplicas: 1
  scaleTargetRef:
    apiVersion: apps/v1
    kind: Deployment
    name: app-1
---
# Source: tests/templates/init-helm-apps-library.yaml
apiVersion: autoscaling/v2beta2
kind: HorizontalPodAutoscaler
metadata:
  annotations:
    helm-apps/version: TEST
  labels:
    app: hpa-app
    chart: tests
    repo: ""
  name: hpa-app
spec:
  behavior:
    scaleDown:
      policies:
      - periodSeconds: 60
        type: Percent
        value: 10
  maxReplicas: 10
  metrics:
  - resource:
      name: cpu
      target:
        averageUtilization: 50
        type: Utilization
    type: Resource
  - object:
      describedObject:
        apiVersion: v1
        kind: Service
        name: hpa-metric-1
      metric:
        name: custom-metric-1
      target:
        type: Value
        value: 10000m
    type: Object
  - resource:
      name: memory
      target:
        averageUtilization: 30
        type: Utilization
    type: Resource
  minReplicas: 3
  scaleTargetRef:
    apiVersion: apps/v1
    kind: Deployment
    name: hpa-app
---
# Source: tests/templates/init-helm-apps-library.yaml
apiVersion: networking.k8s.io/v1
kind: Ingress
metadata:
  annotations:
    kubernetes.io/ingress.class: nginx
    nginx.ingress.kubernetes.io/auth-url: example.org
  labels:
    app: ingress-1
    chart: tests
    repo: ""
  name: ingress-1
spec:
  rules:
  - host: example.org
    http:
      paths:
      - backend:
          service:
            name: testService
            port:
              number: 80
        path: /
        pathType: Prefix
  tls:
  - secretName: test
---
# Source: tests/templates/init-helm-apps-library.yaml
apiVersion: networking.k8s.io/v1
kind: Ingress
metadata:
  annotations:
    kubernetes.io/ingress.class: nginx
  labels:
    app: ingress-2
    chart: tests
    repo: ""
  name: ingress-2
spec:
  rules:
  - host: example.org
    http:
      paths:
      - backend:
          service:
            name: testService
            port:
              number: 80
        path: /
        pathType: Prefix
---
# Source: tests/templates/init-helm-apps-library.yaml
apiVersion: networking.k8s.io/v1
kind: Ingress
metadata:
  annotations:
    kubernetes.io/ingress.class: nginx
  labels:
    app: ingress-3
    chart: tests
    repo: ""
  name: ingress-3
spec:
  rules:
  - host: example.org
    http:
      paths:
      - backend:
          service:
            name: testService
            port:
              number: 80
        path: /
        pathType: Prefix
  tls:
  - secretName: ingress-3
---
# Source: tests/templates/init-helm-apps-library.yaml
apiVersion: networking.k8s.io/v1
kind: Ingress
metadata:
  annotations:
    kubernetes.io/ingress.class: nginx
  labels:
    app: ingress-4
    chart: tests
    repo: ""
  name: ingress-4
spec:
  ingressClassName: nginx
  rules:
  - host: example.org
    http:
      paths:
      - backend:
          service:
            name: testService
            port:
              number: 80
        path: /
        pathType: Prefix
---
# Source: tests/templates/init-helm-apps-library.yaml
apiVersion: networking.k8s.io/v1
kind: Ingress
metadata:
  annotations:
    kubernetes.io/ingress.class: nginx
    nginx.ingress.kubernetes.io/auth-response-headers: X-Auth-Request-User,X-Auth-Request-Email,Authorization
    nginx.ingress.kubernetes.io/auth-signin: https://$host/dex-authenticator/sign_in
    nginx.ingress.kubernetes.io/auth-url: https://ingress-dex-auth-dex-authenticator.test-prod.svc.cluster.local/dex-authenticator/auth
  labels:
    app: ingress-dex-auth
    chart: tests
    repo: ""
  name: ingress-dex-auth
spec:
  ingressClassName: nginx
  rules:
  - host: example.org
    http:
      paths:
      - backend:
          service:
            name: testService
            port:
              number: 80
        path: /
        pathType: Prefix
  tls:
  - secretName: ingress-dex-auth
---
# Source: tests/templates/init-helm-apps-library.yaml
apiVersion: networking.k8s.io/v1
kind: Ingress
metadata:
  annotations:
    kubernetes.io/ingress.class: nginx
  labels:
    app: nginx
    chart: tests
    repo: ""
  name: nginx
spec:
  rules:
  - host: example.com
    http:
      paths:
      - backend:
          service:
            name: nginx
            port:
              number: 80
        path: /
        pathType: Prefix
  tls:
  - secretName: nginx
---
# Source: tests/templates/init-helm-apps-library.yaml
apiVersion: networking.k8s.io/v1
kind: Ingress
metadata:
  annotations: {}
  labels:
    app: test-app-ingress
    chart: tests
    repo: ""
  name: test-app-ingress
spec:
  rules:
  - host: example.com
    http:
      paths:
      - backend:
          service:
            name: testService
            port:
              number: 80
        path: /
        pathType: Prefix
---
# Source: tests/templates/init-helm-apps-library.yaml
apiVersion: batch/v1
kind: Job
metadata:
  annotations:
    helm-apps/version: TEST
    testAnnotation: testVal
  labels:
    app: job-1
    chart: tests
    repo: ""
  name: job-1
spec:
  activeDeadlineSeconds: 1800
  backoffLimit: 0
  template:
    metadata:
      annotations:
        testAnnotation: testVal
      labels:
        app: job-1
        chart: tests
        repo: ""
      name: job-1
    spec:
      activeDeadlineSeconds: 1800
      affinity:
        podAntiAffinity:
          preferredDuringSchedulingIgnoredDuringExecution:
          - podAffinityTerm:
              labelSelector:
                matchLabels:
                  app: job-1
                  chart: tests
                  repo: ""
              topologyKey: kubernetes.io/hostname
            weight: 10
      containers:
      - args:
        - -f
        - /dev/null
        command:
        - tail
        env:
        - name: TEST1
          value: val1
        - name: TEST2
          value: val2
        envFrom:
        - configMapRef:
            name: env-configmap
        - secretRef:
            name: envs-containers-job-1-container-1
        image: alpine:3
        lifecycle:
          preStop:
            exec:
              command:
              - /usr/sbin/nginx
              - -s
              - quit
        name: container-1
        resources:
          limits:
            memory: 200Mi
          requests:
            cpu: 100m
            memory: 200Mi
        volumeMounts:
        - mountPath: /cache
          name: cache-volume
        - mountPath: /etc/nginx/nginx.conf
          name: config-containers-job-1-container-1-nginx-conf
          subPath: nginx.conf
        - mountPath: /etc/secret.conf
          name: config-containers-job-1-container-1-secret-conf
          subPath: secret.conf
      imagePullSecrets:
      - name: registrysecret
      initContainers:
      - args:
        - -f
        - /dev/null
        command:
        - tail
        env:
        - name: TEST1
          value: val1
        envFrom:
        - configMapRef:
            name: env-configmap
        - secretRef:
            name: envs-initcontainers-job-1-init-container-1
        image: alpine:3
        lifecycle:
          preStop:
            exec:
              command:
              - /usr/sbin/nginx
              - -s
              - quit
        name: init-container-1
        resources:
          limits:
            memory: 200Mi
          requests:
            cpu: 100m
            memory: 200Mi
        volumeMounts:
        - mountPath: /cache
          name: cache-volume
        - mountPath: /etc/nginx/nginx.conf
          name: config-initcontainers-job-1-init-container-1-nginx-conf
          subPath: nginx.conf
        - mountPath: /etc/secret.conf
          name: config-initcontainers-job-1-init-container-1-secret-conf
          subPath: secret.conf
      priorityClassName: production-medium
      restartPolicy: Never
      tolerations:
      - key: something
        operator: Equal
        value: somethingelse
      volumes:
      - emptyDir: {}
        name: cache-volume
      - configMap:
          name: config-initcontainers-job-1-init-container-1-nginx-conf
        name: config-initcontainers-job-1-init-container-1-nginx-conf
      - name: config-initcontainers-job-1-init-container-1-secret-conf
        secret:
          secretName: config-initcontainers-job-1-init-container-1-secret-conf
      - configMap:
          name: config-containers-job-1-container-1-nginx-conf
        name: config-containers-job-1-container-1-nginx-conf
      - name: config-containers-job-1-container-1-secret-conf
        secret:
          secretName: config-containers-job-1-container-1-secret-conf
---
# Source: tests/templates/init-helm-apps-library.yaml
apiVersion: v1
kind: LimitRange
metadata:
  annotations:
    helm-apps/version: TEST
  labels:
    app: mem-dafault
    chart: tests
    repo: ""
  name: mem-dafault
spec:
  limits:
  - default:
      memory: 128Mi
    defaultRequest:
      memory: 128Mi
    type: Container
---
# Source: tests/templates/init-helm-apps-library.yaml
apiVersion: v1
kind: PersistentVolumeClaim
metadata:
  annotations:
    helm-apps/version: TEST
  labels:
    app: test-pvc
    chart: tests
    repo: ""
  name: test-pvc
spec:
  accessModes:
  - ReadWriteMany
  resources:
    requests:
      storage: 1Gi
  storageClassName: test-sc
---
# Source: tests/templates/init-helm-apps-library.yaml
apiVersion: policy/v1beta1
kind: PodDisruptionBudget
metadata:
  annotations:
    helm-apps/version: TEST
    testAnnotation: testVal
  labels:
    app: app-1
    chart: tests
    repo: ""
  name: app-1
spec:
  maxUnavailable: 1
  selector:
    matchLabels:
      app: app-1
---
# Source: tests/templates/init-helm-apps-library.yaml
apiVersion: policy/v1beta1
kind: PodDisruptionBudget
metadata:
  annotations:
    helm-apps/version: TEST
    testAnnotation: testVal
  labels:
    app: app-1
    chart: tests
    repo: ""
  name: app-1
spec:
  maxUnavailable: 1
  selector:
    matchLabels:
      app: app-1
---
# Source: tests/templates/init-helm-apps-library.yaml
apiVersion: policy/v1beta1
kind: PodDisruptionBudget
metadata:
  annotations:
    helm-apps/version: TEST
  labels:
    app: app-for-test-from-secrets-env-vars
    chart: tests
    repo: ""
  name: app-for-test-from-secrets-env-vars
spec:
  maxUnavailable: 15%
  selector:
    matchLabels:
      app: app-for-test-from-secrets-env-vars
---
# Source: tests/templates/init-helm-apps-library.yaml
apiVersion: policy/v1beta1
kind: PodDisruptionBudget
metadata:
  annotations:
    helm-apps/version: TEST
  labels:
    app: app-with-deckhouse-metrics
    chart: tests
    repo: ""
  name: app-with-deckhouse-metrics
spec:
  maxUnavailable: 15%
  selector:
    matchLabels:
      app: app-with-deckhouse-metrics
---
# Source: tests/templates/init-helm-apps-library.yaml
apiVersion: policy/v1beta1
kind: PodDisruptionBudget
metadata:
  annotations:
    helm-apps/version: TEST
  labels:
    app: env-yaml-app
    chart: tests
    repo: ""
  name: env-yaml-app
spec:
  maxUnavailable: 15%
  selector:
    matchLabels:
      app: env-yaml-app
---
# Source: tests/templates/init-helm-apps-library.yaml
apiVersion: policy/v1beta1
kind: PodDisruptionBudget
metadata:
  annotations:
    helm-apps/version: TEST
  labels:
    app: hpa-app
    chart: tests
    repo: ""
  name: hpa-app
spec:
  maxUnavailable: 15%
  selector:
    matchLabels:
      app: my-selector
---
# Source: tests/templates/init-helm-apps-library.yaml
apiVersion: policy/v1beta1
kind: PodDisruptionBudget
metadata:
  annotations:
    helm-apps/version: TEST
  labels:
    app: minimum-app
    chart: tests
    repo: ""
  name: minimum-app
spec:
  maxUnavailable: 15%
  selector:
    matchLabels:
      app: minimum-app
---
# Source: tests/templates/init-helm-apps-library.yaml
apiVersion: policy/v1beta1
kind: PodDisruptionBudget
metadata:
  annotations:
    helm-apps/version: TEST
  labels:
    app: nginx
    chart: tests
    repo: ""
  name: nginx
spec:
  maxUnavailable: 15%
  selector:
    matchLabels:
      app: nginx
---
# Source: tests/templates/init-helm-apps-library.yaml
apiVersion: policy/v1beta1
kind: PodDisruptionBudget
metadata:
  annotations:
    helm-apps/version: TEST
  labels:
    app: pod-disruption-budget-integer
    chart: tests
    repo: ""
  name: pod-disruption-budget-integer
spec:
  maxUnavailable: 1
  selector:
    matchLabels:
      app: pod-disruption-budget-integer
---
# Source: tests/templates/init-helm-apps-library.yaml
apiVersion: policy/v1beta1
kind: PodDisruptionBudget
metadata:
  annotations:
    helm-apps/version: TEST
  labels:
    app: stateful-simple
    chart: tests
    repo: ""
  name: stateful-simple
spec:
  maxUnavailable: 15%
  selector:
    matchLabels:
      app: stateful-simple
---
# Source: tests/templates/init-helm-apps-library.yaml
apiVersion: policy/v1beta1
kind: PodDisruptionBudget
metadata:
  annotations:
    helm-apps/version: TEST
  labels:
    app: test-app
    chart: tests
    repo: ""
  name: test-app
spec:
  maxUnavailable: 15%
  selector:
    matchLabels:
      app: test-app
---
# Source: tests/templates/init-helm-apps-library.yaml
apiVersion: policy/v1beta1
kind: PodDisruptionBudget
metadata:
  annotations:
    helm-apps/version: TEST
  labels:
    app: test-app-2
    chart: tests
    repo: ""
  name: test-app-2
spec:
  maxUnavailable: 15%
  selector:
    matchLabels:
      app: test-app-2
---
# Source: tests/templates/init-helm-apps-library.yaml
apiVersion: deckhouse.io/v1beta1
kind: PodMetric
metadata:
  annotations:
    helm-apps/version: TEST
  labels:
    app: app-with-deckhouse-metrics
    chart: tests
    repo: ""
  name: app-with-deckhouse-metrics-mymetric-1
spec:
  query: round(sum by(<<.GroupBy>>) (phpfpm_processes_total{state="active",<<.LabelMatchers>>})
    / sum by(<<.GroupBy>>) (phpfpm_processes_total{<<.LabelMatchers>>}) * 100)
---
# Source: tests/templates/init-helm-apps-library.yaml
apiVersion: v1
data:
  secret.conf: c2VjcmV0bGluZTEKc2VjcmV0bGluZTIK
kind: Secret
metadata:
  annotations:
    helm-apps/version: TEST
    testAnnotation: testVal
  labels:
    app: app-1
    chart: tests
    repo: ""
  name: config-containers-app-1-container-1-secret-conf
type: Opaque
---
# Source: tests/templates/init-helm-apps-library.yaml
apiVersion: v1
data:
  secret.conf: c2VjcmV0bGluZTEKc2VjcmV0bGluZTIK
kind: Secret
metadata:
  annotations:
    helm-apps/version: TEST
    testAnnotation: testVal
  labels:
    app: app-1
    chart: tests
    repo: ""
  name: config-containers-app-1-container-1-secret-conf
type: Opaque
---
# Source: tests/templates/init-helm-apps-library.yaml
apiVersion: v1
data:
  secret.conf: c2VjcmV0bGluZTEKc2VjcmV0bGluZTIK
kind: Secret
metadata:
  annotations:
    helm-apps/version: TEST
    testAnnotation: testVal
  labels:
    app: cronjob-1
    chart: tests
    repo: ""
  name: config-containers-cronjob-1-container-1-secret-conf
type: Opaque
---
# Source: tests/templates/init-helm-apps-library.yaml
apiVersion: v1
data:
  secret.conf: c2VjcmV0bGluZTEKc2VjcmV0bGluZTIK
kind: Secret
metadata:
  annotations:
    helm-apps/version: TEST
    testAnnotation: testVal
  labels:
    app: job-1
    chart: tests
    repo: ""
  name: config-containers-job-1-container-1-secret-conf
type: Opaque
---
# Source: tests/templates/init-helm-apps-library.yaml
apiVersion: v1
data:
  secret.conf: c2VjcmV0bGluZTEK
kind: Secret
metadata:
  annotations:
    helm-apps/version: TEST
    testAnnotation: testVal
  labels:
    app: app-1
    chart: tests
    repo: ""
  name: config-initcontainers-app-1-init-container-1-secret-conf
type: Opaque
---
# Source: tests/templates/init-helm-apps-library.yaml
apiVersion: v1
data:
  secret.conf: c2VjcmV0bGluZTEK
kind: Secret
metadata:
  annotations:
    helm-apps/version: TEST
    testAnnotation: testVal
  labels:
    app: app-1
    chart: tests
    repo: ""
  name: config-initcontainers-app-1-init-container-1-secret-conf
type: Opaque
---
# Source: tests/templates/init-helm-apps-library.yaml
apiVersion: v1
data:
  secret.conf: c2VjcmV0bGluZTEK
kind: Secret
metadata:
  annotations:
    helm-apps/version: TEST
    testAnnotation: testVal
  labels:
    app: cronjob-1
    chart: tests
    repo: ""
  name: config-initcontainers-cronjob-1-init-container-1-secret-conf
type: Opaque
---
# Source: tests/templates/init-helm-apps-library.yaml
apiVersion: v1
data:
  secret.conf: c2VjcmV0bGluZTEK
kind: Secret
metadata:
  annotations:
    helm-apps/version: TEST
    testAnnotation: testVal
  labels:
    app: job-1
    chart: tests
    repo: ""
  name: config-initcontainers-job-1-init-container-1-secret-conf
type: Opaque
---
# Source: tests/templates/init-helm-apps-library.yaml
apiVersion: v1
data:
  TEST1: dmFsMQ==
  TEST2: dmFsMg==
kind: Secret
metadata:
  annotations:
    helm-apps/version: TEST
    testAnnotation: testVal
  labels:
    app: app-1
    chart: tests
    repo: ""
  name: envs-containers-app-1-container-1
type: Opaque
---
# Source: tests/templates/init-helm-apps-library.yaml
apiVersion: v1
data:
  TEST1: dmFsMQ==
  TEST2: dmFsMg==
kind: Secret
metadata:
  annotations:
    helm-apps/version: TEST
    testAnnotation: testVal
  labels:
    app: app-1
    chart: tests
    repo: ""
  name: envs-containers-app-1-container-1
type: Opaque
---
# Source: tests/templates/init-helm-apps-library.yaml
apiVersion: v1
data:
  TEST1: dmFsMQ==
  TEST2: dmFsMg==
kind: Secret
metadata:
  annotations:
    helm-apps/version: TEST
    testAnnotation: testVal
  labels:
    app: cronjob-1
    chart: tests
    repo: ""
  name: envs-containers-cronjob-1-container-1
type: Opaque
---
# Source: tests/templates/init-helm-apps-library.yaml
apiVersion: v1
data:
  TEST_APP_LEVEL1_TEST_ENV3: ZGVmYXVsdCB2YWx1ZSBmcm9tIGVudlZhcnM=
kind: Secret
metadata:
  annotations:
    helm-apps/version: TEST
  labels:
    app: env-yaml-app
    chart: tests
    repo: ""
  name: envs-containers-env-yaml-app-test
type: Opaque
---
# Source: tests/templates/init-helm-apps-library.yaml
apiVersion: v1
data:
  TEST1: dmFsMQ==
  TEST2: dmFsMg==
kind: Secret
metadata:
  annotations:
    helm-apps/version: TEST
    testAnnotation: testVal
  labels:
    app: job-1
    chart: tests
    repo: ""
  name: envs-containers-job-1-container-1
type: Opaque
---
# Source: tests/templates/init-helm-apps-library.yaml
apiVersion: v1
data:
  SECRET_TOKEN: ISEhc2VjcmV0LXRva2VuLWZvci1iYWNrZW5kISEh
kind: Secret
metadata:
  annotations:
    helm-apps/version: TEST
  labels:
    app: nginx
    chart: tests
    repo: ""
  name: envs-containers-nginx-nginx
type: Opaque
---
# Source: tests/templates/init-helm-apps-library.yaml
apiVersion: v1
data:
  TEST1: dmFsMQ==
kind: Secret
metadata:
  annotations:
    helm-apps/version: TEST
    testAnnotation: testVal
  labels:
    app: app-1
    chart: tests
    repo: ""
  name: envs-initcontainers-app-1-init-container-1
type: Opaque
---
# Source: tests/templates/init-helm-apps-library.yaml
apiVersion: v1
data:
  TEST1: dmFsMQ==
kind: Secret
metadata:
  annotations:
    helm-apps/version: TEST
    testAnnotation: testVal
  labels:
    app: app-1
    chart: tests
    repo: ""
  name: envs-initcontainers-app-1-init-container-1
type: Opaque
---
# Source: tests/templates/init-helm-apps-library.yaml
apiVersion: v1
data:
  TEST1: dmFsMQ==
kind: Secret
metadata:
  annotations:
    helm-apps/version: TEST
    testAnnotation: testVal
  labels:
    app: cronjob-1
    chart: tests
    repo: ""
  name: envs-initcontainers-cronjob-1-init-container-1
type: Opaque
---
# Source: tests/templates/init-helm-apps-library.yaml
apiVersion: v1
data:
  TEST1: dmFsMQ==
kind: Secret
metadata:
  annotations:
    helm-apps/version: TEST
    testAnnotation: testVal
  labels:
    app: job-1
    chart: tests
    repo: ""
  name: envs-initcontainers-job-1-init-container-1
type: Opaque
---
# Source: tests/templates/init-helm-apps-library.yaml
apiVersion: v1
data:
  TEST1: dmFsMQ==
  TEST2: dmFsMg==
  secret.conf: cGxhaW5UZXh0TGluZTEKcGxhaW5UZXh0TGluZTIK
  secret2.conf: cGxhaW5UZXh0TGluZTEK
kind: Secret
metadata:
  annotations:
    helm-apps/version: TEST
  labels:
    app: secret-1
    chart: tests
    repo: ""
  name: secret-1
type: Opaque
---
# Source: tests/templates/init-helm-apps-library.yaml
apiVersion: v1
kind: Service
metadata:
  annotations:
    helm-apps/version: TEST
    testAnnotation: testVal
  labels:
    app: app-1
    chart: tests
    repo: ""
  name: app-1
spec:
  clusterIP: None
  ports:
  - name: http
    port: 80
  selector:
    app: app-1
---
# Source: tests/templates/init-helm-apps-library.yaml
apiVersion: v1
kind: Service
metadata:
  annotations:
    helm-apps/version: TEST
    testAnnotation: testVal
  labels:
    app: app-1
    chart: tests
    repo: ""
    testLabel: testVal
  name: app-1
spec:
  clusterIP: None
  ports:
  - name: http
    port: 80
  selector:
    app: app-1
---
# Source: tests/templates/init-helm-apps-library.yaml
apiVersion: v1
kind: Service
metadata:
  annotations:
    helm-apps/version: TEST
  labels:
    app: hpa-app
    chart: tests
    repo: ""
  name: hpa-app
spec:
  ports:
  - name: http
    port: 80
  selector:
    app: my-selector
---
# Source: tests/templates/init-helm-apps-library.yaml
apiVersion: v1
kind: Service
metadata:
  annotations:
    helm-apps/version: TEST
  labels:
    app: nginx
    chart: tests
    repo: ""
  name: nginx
spec:
  ports:
  - name: http
    port: 80
  selector:
    app: nginx
---
# Source: tests/templates/init-helm-apps-library.yaml
apiVersion: v1
kind: Service
metadata:
  annotations:
    helm-apps/version: TEST
  labels:
    app: service-1
    chart: tests
    repo: ""
  name: service-1
spec:
  ports:
  - name: http
    port: 80
  selector:
    app: test-app
---
# Source: tests/templates/init-helm-apps-library.yaml
apiVersion: v1
kind: ServiceAccount
metadata:
  annotations:
    helm-apps/version: TEST
  labels:
    app: test-app
    chart: tests
    repo: ""
  name: test-app
---
# Source: tests/templates/init-helm-apps-library.yaml
apiVersion: v1
kind: ServiceAccount
metadata:
  annotations:
    helm-apps/version: TEST
  labels:
    app: test-app-2
    chart: tests
    repo: ""
  name: test-app-2
---
# Source: tests/templates/init-helm-apps-library.yaml
apiVersion: deckhouse.io/v1beta1
kind: ServiceMetric
metadata:
  annotations:
    helm-apps/version: TEST
  labels:
    app: custom-metric-1
    chart: tests
    repo: ""
  name: custom-metric-1
spec:
  query: sum(rate(sidekiq_jobs_enqueued_total{<<.LabelMatchers>>, queue="default"}[1m]))
    by (<<.GroupBy>>)
---
# Source: tests/templates/init-helm-apps-library.yaml
apiVersion: deckhouse.io/v1beta1
kind: ServiceMetric
metadata:
  annotations:
    helm-apps/version: TEST
  labels:
    app: metric-1
    chart: tests
    repo: ""
  name: metric-1
spec:
  query: sum(rate(sidekiq_jobs_enqueued_total{<<.LabelMatchers>>, queue="default"}[1m]))
    by (<<.GroupBy>>)
---
# Source: tests/templates/init-helm-apps-library.yaml
apiVersion: apps/v1
kind: StatefulSet
metadata:
  annotations:
    checksum/config: 14aeb92c2c444a2623279fd0cf52ac8522bf5485f312a111a64b1a112a5beaad
    helm-apps/version: TEST
    testAnnotation: testVal
  labels:
    app: app-1
    chart: tests
    repo: ""
    testLabel: testVal
  name: app-1
spec:
  replicas: 2
  revisionHistoryLimit: 3
  selector:
    matchLabels:
      app: app-1
  serviceName: app-1
  template:
    metadata:
      annotations:
        checksum/config: 14aeb92c2c444a2623279fd0cf52ac8522bf5485f312a111a64b1a112a5beaad
        testAnnotation: testVal
      labels:
        app: app-1
        chart: tests
        repo: ""
        testLabel: testVal
      name: app-1
    spec:
      affinity:
        podAntiAffinity:
          preferredDuringSchedulingIgnoredDuringExecution:
          - podAffinityTerm:
              labelSelector:
                matchLabels:
                  app: app-1
                  chart: tests
                  repo: ""
              topologyKey: kubernetes.io/hostname
            weight: 10
      containers:
      - args:
        - -f
        - /dev/null
        command:
        - tail
        env:
        - name: TEST1
          value: val1
        - name: TEST2
          value: val2
        envFrom:
        - configMapRef:
            name: env-configmap
        - secretRef:
            name: envs-containers-app-1-container-1
        image: alpine:3
        lifecycle:
          preStop:
            exec:
              command:
              - /usr/sbin/nginx
              - -s
              - quit
        livenessProbe:
          httpGet:
            path: /liveness
            port: 80
        name: container-1
        ports:
        - containerPort: 80
          name: http
        readinessProbe:
          httpGet:
            path: /readiness
            port: 80
        resources:
          limits:
            memory: 200Mi
          requests:
            cpu: 100m
            memory: 200Mi
        startupProbe:
          httpGet:
            path: /startup
            port: 80
        volumeMounts:
        - mountPath: /cache
          name: cache-volume
        - mountPath: /etc/nginx/nginx.conf
          name: config-containers-app-1-container-1-nginx-conf
          subPath: nginx.conf
        - mountPath: /etc/nginx/nginx2.conf
          name: config-containers-app-1-container-1-nginx-conf2
          subPath: nginx.conf2
        - mountPath: /etc/secret.conf
          name: config-containers-app-1-container-1-secret-conf
          subPath: secret.conf
        - mountPath: /data2
          name: data2-containers-app-1-container-1--data2
      dnsPolicy: ClusterFirstWithHostNet
      hostNetwork: true
      imagePullSecrets:
      - name: registrysecret
      initContainers:
      - args:
        - -f
        - /dev/null
        command:
        - tail
        env:
        - name: TEST1
          value: val1
        envFrom:
        - configMapRef:
            name: env-configmap
        - secretRef:
            name: envs-initcontainers-app-1-init-container-1
        image: alpine:3
        lifecycle:
          preStop:
            exec:
              command:
              - /usr/sbin/nginx
              - -s
              - quit
        name: init-container-1
        resources:
          limits:
            memory: 200Mi
          requests:
            cpu: 100m
            memory: 200Mi
        volumeMounts:
        - mountPath: /cache
          name: cache-volume
        - mountPath: /etc/nginx/nginx.conf
          name: config-initcontainers-app-1-init-container-1-nginx-conf
          subPath: nginx.conf
        - mountPath: /etc/secret.conf
          name: config-initcontainers-app-1-init-container-1-secret-conf
          subPath: secret.conf
      nodeSelector:
        label1: value1
        label2: value2
      priorityClassName: production-medium
      terminationGracePeriodSeconds: 30
      tolerations:
      - key: something
        operator: Equal
        value: somethingelse
      volumes:
      - emptyDir: {}
        name: cache-volume
      - configMap:
          name: config-initcontainers-app-1-init-container-1-nginx-conf
        name: config-initcontainers-app-1-init-container-1-nginx-conf
      - name: config-initcontainers-app-1-init-container-1-secret-conf
        secret:
          secretName: config-initcontainers-app-1-init-container-1-secret-conf
      - configMap:
          name: config-containers-app-1-container-1-nginx-conf
        name: config-containers-app-1-container-1-nginx-conf
      - configMap:
          name: configmap-1
        name: config-containers-app-1-container-1-nginx-conf2
      - name: config-containers-app-1-container-1-secret-conf
        secret:
          secretName: config-containers-app-1-container-1-secret-conf
  volumeClaimTemplates:
  - metadata:
      name: data2-containers-app-1-container-1--data2
    spec:
      accessModes:
      - ReadWriteOnce
      resources:
        requests:
          storage: 1Gi
      storageClassName: localStorage
      volumeMode: Filesystem
---
# Source: tests/templates/init-helm-apps-library.yaml
apiVersion: apps/v1
kind: StatefulSet
metadata:
  annotations:
    checksum/config: e3b0c44298fc1c149afbf4c8996fb92427ae41e4649b934ca495991b7852b855
    helm-apps/version: TEST
  labels:
    app: stateful-simple
    chart: tests
    repo: ""
  name: stateful-simple
spec:
  revisionHistoryLimit: 3
  selector:
    matchLabels:
      app: stateful-simple
  serviceName: stateful-simple
  template:
    metadata:
      annotations:
        checksum/config: e3b0c44298fc1c149afbf4c8996fb92427ae41e4649b934ca495991b7852b855
      labels:
        app: stateful-simple
        chart: tests
        repo: ""
      name: stateful-simple
    spec:
      affinity:
        podAntiAffinity:
          preferredDuringSchedulingIgnoredDuringExecution:
          - podAffinityTerm:
              labelSelector:
                matchLabels:
                  app: stateful-simple
              topologyKey: kubernetes.io/hostname
            weight: 10
      containers:
      - image: REPO:TAG
        name: main
      imagePullSecrets:
      - name: registrysecret
      priorityClassName: production-medium
      terminationGracePeriodSeconds: 60
---
# Source: tests/templates/init-helm-apps-library.yaml
apiVersion: autoscaling.k8s.io/v1
kind: VerticalPodAutoscaler
metadata:
  annotations:
    helm-apps/version: TEST
    testAnnotation: testVal
  labels:
    app: app-1
    chart: tests
    repo: ""
  name: app-1
spec:
  resourcePolicy:
    containerPolicies:
    - containerName: some-container
      mode: "Off"
  targetRef:
    apiVersion: apps/v1
    kind: Deployment
    name: app-1
  updatePolicy:
    updateMode: Auto
---
# Source: tests/templates/init-helm-apps-library.yaml
apiVersion: autoscaling.k8s.io/v1
kind: VerticalPodAutoscaler
metadata:
  annotations:
    helm-apps/version: TEST
    testAnnotation: testVal
  labels:
    app: app-1
    chart: tests
    repo: ""
  name: app-1
spec:
  resourcePolicy:
    containerPolicies:
    - containerName: some-container
      mode: "Off"
  targetRef:
    apiVersion: apps/v1
    kind: StatefulSet
    name: app-1
  updatePolicy:
    updateMode: "Off"
---
# Source: tests/templates/init-helm-apps-library.yaml
apiVersion: autoscaling.k8s.io/v1
kind: VerticalPodAutoscaler
metadata:
  annotations:
    helm-apps/version: TEST
  labels:
    app: app-with-deckhouse-metrics
    chart: tests
    repo: ""
  name: app-with-deckhouse-metrics
spec:
  resourcePolicy: {}
  targetRef:
    apiVersion: apps/v1
    kind: Deployment
    name: app-with-deckhouse-metrics
  updatePolicy:
    updateMode: "Off"
---
# Source: tests/templates/init-helm-apps-library.yaml
apiVersion: autoscaling.k8s.io/v1
kind: VerticalPodAutoscaler
metadata:
  annotations:
    helm-apps/version: TEST
    testAnnotation: testVal
  labels:
    app: cronjob-1
    chart: tests
    repo: ""
  name: cronjob-1
spec:
  resourcePolicy:
    containerPolicies:
    - containerName: some-container
      mode: "Off"
  targetRef:
    apiVersion: batch/v1beta1
    kind: CronJob
    name: cronjob-1
  updatePolicy:
    updateMode: Initial
---
# Source: tests/templates/init-helm-apps-library.yaml
apiVersion: autoscaling.k8s.io/v1
kind: VerticalPodAutoscaler
metadata:
  annotations:
    helm-apps/version: TEST
  labels:
    app: env-yaml-app
    chart: tests
    repo: ""
  name: env-yaml-app
spec:
  resourcePolicy: {}
  targetRef:
    apiVersion: apps/v1
    kind: Deployment
    name: env-yaml-app
  updatePolicy:
    updateMode: "Off"
---
# Source: tests/templates/init-helm-apps-library.yaml
apiVersion: autoscaling.k8s.io/v1
kind: VerticalPodAutoscaler
metadata:
  annotations:
    helm-apps/version: TEST
  labels:
    app: hpa-app
    chart: tests
    repo: ""
  name: hpa-app
spec:
  resourcePolicy: {}
  targetRef:
    apiVersion: apps/v1
    kind: Deployment
    name: hpa-app
  updatePolicy:
    updateMode: "Off"
---
# Source: tests/templates/init-helm-apps-library.yaml
apiVersion: autoscaling.k8s.io/v1
kind: VerticalPodAutoscaler
metadata:
  annotations:
    helm-apps/version: TEST
    testAnnotation: testVal
  labels:
    app: job-1
    chart: tests
    repo: ""
  name: job-1
spec:
  resourcePolicy:
    containerPolicies:
    - containerName: some-container
      mode: "Off"
  targetRef:
    apiVersion: batch/v1
    kind: Job
    name: job-1
  updatePolicy:
    updateMode: Initial
---
# Source: tests/templates/init-helm-apps-library.yaml
apiVersion: autoscaling.k8s.io/v1
kind: VerticalPodAutoscaler
metadata:
  annotations:
    helm-apps/version: TEST
  labels:
    app: minimum-app
    chart: tests
    repo: ""
  name: minimum-app
spec:
  resourcePolicy: {}
  targetRef:
    apiVersion: apps/v1
    kind: Deployment
    name: minimum-app
  updatePolicy:
    updateMode: "Off"
---
# Source: tests/templates/init-helm-apps-library.yaml
apiVersion: autoscaling.k8s.io/v1
kind: VerticalPodAutoscaler
metadata:
  annotations:
    helm-apps/version: TEST
  labels:
    app: nginx
    chart: tests
    repo: ""
  name: nginx
spec:
  resourcePolicy: {}
  targetRef:
    apiVersion: apps/v1
    kind: Deployment
    name: nginx
  updatePolicy:
    updateMode: "Off"
---
# Source: tests/templates/init-helm-apps-library.yaml
apiVersion: autoscaling.k8s.io/v1
kind: VerticalPodAutoscaler
metadata:
  annotations:
    helm-apps/version: TEST
  labels:
    app: pod-disruption-budget-integer
    chart: tests
    repo: ""
  name: pod-disruption-budget-integer
spec:
  resourcePolicy: {}
  targetRef:
    apiVersion: apps/v1
    kind: Deployment
    name: pod-disruption-budget-integer
  updatePolicy:
    updateMode: "Off"
---
# Source: tests/templates/init-helm-apps-library.yaml
apiVersion: autoscaling.k8s.io/v1
kind: VerticalPodAutoscaler
metadata:
  annotations:
    helm-apps/version: TEST
  labels:
    app: stateful-simple
    chart: tests
    repo: ""
  name: stateful-simple
spec:
  resourcePolicy: {}
  targetRef:
    apiVersion: apps/v1
    kind: StatefulSet
    name: stateful-simple
  updatePolicy:
    updateMode: "Off"
---
# Source: tests/templates/init-helm-apps-library.yaml
apiVersion: autoscaling.k8s.io/v1
kind: VerticalPodAutoscaler
metadata:
  annotations:
    helm-apps/version: TEST
  labels:
    app: test-app
    chart: tests
    repo: ""
  name: test-app
spec:
  resourcePolicy: {}
  targetRef:
    apiVersion: apps/v1
    kind: Deployment
    name: test-app
  updatePolicy:
    updateMode: "Off"
---
# Source: tests/templates/init-helm-apps-library.yaml
apiVersion: autoscaling.k8s.io/v1
kind: VerticalPodAutoscaler
metadata:
  annotations:
    helm-apps/version: TEST
  labels:
    app: test-app-2
    chart: tests
    repo: ""
  name: test-app-2
spec:
  resourcePolicy: {}
  targetRef:
    apiVersion: apps/v1
    kind: Deployment
    name: test-app-2
  updatePolicy:
    updateMode: "Off"
